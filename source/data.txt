### |----------------------------------------------------------------------------------------------------------------------------------------------------------------------|
### |Release Date: 2023/2/21 by Regina Shih                                                                                                                                |
### |Function_V6.2 (1038):                                                                                                                                                 |
### |System(98) + WAN(341) + LAN(90) + NAT(76) + Security(109) + QoS(59) + RemoteMGMT(194) + QuickStart(1) + VoIP(63) + GPON Unbundle(7)                                   |
### |Release Note:                                                                                                                                                         |
### |[Reduce False Alarms]                                                                                                                                                 |                                                                                                                               
### |   1. OPAL-1302: Use loop method to confirm the maximum rules. (Bug #180856)                                                                                          |
### |   2. OPAL-697/OPAL-709/OPAL-1111/OPAL-1141/OPAL-1340: Change LAN DHCP pool range and set LAN2/DMZ WKS to static IP to prevent IP conflict issue.                     |                                                                                                                
### |   3. OPAL-1448: Enhance "::CONSOLE::Check_WKS_Telnet_Exist" and use this method to check warning message when using Telnet to login CPE with incorrect user name.    |                                                                                                                                                                       
### |   4. Enhance some script writing method. Ex: Check DUT setting before click GUI Enable/Disable button. Add waiting time or retry mechanism in some cases.            |
### |      Delete the configuration file in Download folder before testing.                                                                                                |
### |   5. Modify < Ping Internet > API: Add check point to ping NAT_WKS IP address to make sure DUT WAN status.                                                           |
### |                                                                                                                                                                      |                                                                                                                                                                       
### |[Enhancement]                                                                                                                                                         |          
### |   1. OPAL-1937/OPAL-1941: The type of TR-069 password and connection request password fields change from unmaskPassword to maskPassword.                             |                                                      
### |   2. OPAL-1681/OPAL-16101/OPAL-1694/OPAL-1696/OPAL-1706/OPAL-1764/OPAL-1765/OPAL-1766/OPAL-1768/OPAL-1769: For make sure DUT VoIP behavior is correct and for debug, |
### |      add step of checking SIP packet sent from DUT.                                                                                                                  |
### |   3. Enhance some script writing method. Ex: Replace some value with variable. Change method of capturing packets and download packets in report for debug.          |
### |      Add test step about setting WAN for PON model.                                                                                                                  |                                                                                             
### |   4. For some MAC Filter cases, use GUI or TR-069 to set instead of CLI.                                                                                             |                                                                             
### |   5. Change the order of some cases to reduce test time or false alarm.                                                                                              |                                                                             
### |                                                                                                                                                                      |                                                                                                                                                                       
### |[Script Bug Fixed]                                                                                                                                                    |                                                                                                                                                                                                                                                                                               
### |   1. OPAL-674/OPAL-676/OPAL-748/OPAL-771/OPAL-775/OPAL-779/OPAL-780: DX5401-B0 supports Mesh R2, index of WAN interface is different from other Generic models.      |
### |   2. OPAL-1262/OPAL-1263/OPAL-1266/OPAL-1267: Follow test step, check Ping packets from WAN side instead of using "tracert".                                         |                                                                                                                                                                                                                                                                                 
### |   3. OPAL-12172/OPAL-12173/OPAL-12174/OPAL-12176/OPAL-12177/OPAL-12178/OPAL-12179: Admin account can't access GPON page, change login account from admin to          |                                                                                                                                 
### |      supervisor to configure GPON settings.                                                                                                                          |                                                                                                                                                               
### |                                                                                                                                                                      |
### |[Remove]                                                                                                                                                              |
### |   1. OPAL-279: Can't verify "LAN delegate prefix from non-default gateway" behavior in ACTS environment.                                                             |                                                                                                                        
### |   2. OPAL-2015/OPAL-2016: The WAN2 IPv6 routing is not ready in ACTS environment, WAN_WKS can't access DUT WAN. (ACTS platform issue)                                |
### |   3. OPAL-282/OPAL-297/OPAL-349/OPAL-485/OPAL-505/OPAL-507: DNSv6 server is not ready in ACTS environment. (ACTS platform issue)                                     |
### |   4. OPAL-31: Starting ExpressBoot tool would let ACTS hang, so remove cases with ExpressBoot content. (ACTS platform issue)                                         |
### |   5. OPAL-1699/OPAL-1707: The test step needs to capture RTP packets. ACTS not support make call so can not check RTP packets.                                       |
### |   6. OPAL-1631/OPAL-1633/OPAL-1635: ACTS can not control SIP Proxy Server Address field. (Bug #181583)                                                               |                                                                                     
### |----------------------------------------------------------------------------------------------------------------------------------------------------------------------|                    

                                            
                                                   
%ENV-BAT|L1|L2|L3|StopOnFail%                                                           
+CaseStart+
< ===== Back to Factory Default Settings ===== >
               
::CONSOLE::Local
# Reset ACTS environment SSH record     
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {} {acts} {1234}
::CONSOLE::CI_Cmd_More {} {c:} {5} {cd Documents and Settings} {5} {cd acts} {5} {cd .ssh} {5} {del known_hosts} {5} {dir} {5}
::CONSOLE::Close_Shell {DOS_Shell}
::CONSOLE::Wait {3}
    
# Enable switch's Ethernet port
::MISC::Enable_Network_Interface {LAN1} {Enable}
::MISC::Enable_Network_Interface {LAN2} {Enable}
::MISC::Enable_Network_Interface {DMZ} {Enable}
::CONSOLE::Wait {5}
            
# Reset device setting by command and upgrade firmware 
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {sys atcd}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {sys atcr reboot}
::CONSOLE::Wait {200}

::MISC::MacroExcute {Setup_PC_Interface_to_DHCP} {LAN1} {$LANIFDefaultAddress$} {Don't Care}
::CONSOLE::Wait {2}
::CONSOLE::Setup_WKS_IP_Address {LAN1_WKS} {eth1} {DHCP} {$LANIFDefaultAddress$} {Don't Care}
::CONSOLE::Wait {2}
::CONSOLE::Setup_WKS_IP_Address {LAN2_WKS} {eth1} {DHCP} {$LANIFDefaultAddress$} {Don't Care}
::CONSOLE::Wait {2}
::CONSOLE::Setup_WKS_IP_Address {DMZ_WKS} {eth1} {DHCP} {$LANIFDefaultAddress$} {Don't Care}
::CONSOLE::Wait {2}

# Login WebGUI
<TCL_Block_Begin>    
if { "$PROJECT$" == "WIND" || "$PROJECT$" == "TMNL" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"       
} elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
} else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
}
<TCL_Block_End>
          
# Upgrade firmware
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_File_Dialog {id} {filename} {$Tool File Path$/firmware/ras.bin} {20}
::CONSOLE::Wait {3}     
::WEB::WebDrv_Click {id} {upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}
::CONSOLE::Wait {2} 

# Check device firmware version
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
   }
<TCL_Block_End>

::CONSOLE::Wait {10}
::WEB::WebDrv_Check_Text {id} {card_sysinfo_fwversion} {$FIRMWARE_VERSION$} {20} {PASS} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Reset device to factory default
# Change admin password and set default ETH/PON WAN up
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default.dlf}
   } else {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default_Project.dlf}
   }
<TCL_Block_End>

# Check default route interface (Check WAN get IP address)
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd_Scan {} {ip route} {30} {default via} {172.202.77.1}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {1}

# Clear device record at Axiros server 
::USER_DEFINE::TR069ClearCPEsInACS

# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}

# Clear Axiros server log record
::MISC::Include {$Tool File Path$/Include/Clear_axires_all_log.dlf}

# Environment check
::MISC::Include {$Tool File Path$/Include/Environment_Check.dlf}

-CaseEnd-



%ENV-BAT|L1|L2|L3|StopOnFail%                                                           
+CaseStart+
< ===== Setup ACTS Environment ===== >

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>

::CONSOLE::Local
# Create configuration file "wificonfig"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Create configuration file "wificonfig"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::Backup_Restore_Modify "Backup_Restore.conf"
   } else {
     ::TESTLINK::Backup_Restore_Modify
   }
<TCL_Block_End>

# Modify SSID to "rom-d-test-0" 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
set ::ssid ""
::WEB::WebDrv_Get_Value {id} {wifi_ssid_000_11general11_000} {::ssid} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {rom-d-test-0} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Backup config file and rename to CoNFIg1229 and RoMEdAY224
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Rename config file name
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     file copy -force "C:/Users/acts/Downloads/Backup_Restore.conf" "$Tool File Path$/config/RoMEdAY224"
     file copy -force "C:/Users/acts/Downloads/Backup_Restore.conf" "$Tool File Path$/config/CoNFIg1229"
     file delete -force "C:/Users/acts/Downloads/Backup_Restore.conf"
   } else {
     file copy -force "C:/Users/acts/Downloads/Backup_Restore" "$Tool File Path$/config/RoMEdAY224"
     file copy -force "C:/Users/acts/Downloads/Backup_Restore" "$Tool File Path$/config/CoNFIg1229"
     file delete -force "C:/Users/acts/Downloads/Backup_Restore"
   }
<TCL_Block_End> 

# Restore SSID to default value 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} "$::ssid" {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# ==================== [Add WAN MAC for IPv6 environment] ===================== #
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     # IPv6 can't work well
     ::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
     ::CONSOLE::Wait {5}
     ::CONSOLE::CI_Cmd {} {reboot}
   } else {
     ::MISC::Include {$Tool File Path$/Include/NAT_Ipv6_config.dlf}
   }
<TCL_Block_End>

# =========================== [Restart workstation] =========================== # 
::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {LAN1_WKS} {root} {1234}
::CONSOLE::Wait {5}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {5}

::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN2} {SSH} {LAN2_WKS} {root} {1234}
::CONSOLE::Wait {5}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {5}

::CONSOLE::Use_ZLD_WKS_Login {Shell_1_DMZ} {SSH} {DMZ_WKS} {root} {1234}
::CONSOLE::Wait {5}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {5}

::CONSOLE::Use_ZLD_WKS_Login {Shell_1_WAN} {SSH} {WAN_WKS} {root} {1234}
::CONSOLE::Wait {5}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {5}

# Check NAT Ping success response time
<TCL_Block_Begin> 
  set used_time 0
  set begin_time [clock seconds]
  set result "FAIL"
  while { $used_time < 120 } { 
    set result [::USER_DEFINE::Check_PC_Ping {10.150.150.187} {100} {5} {5} {PASS}]
    if { ($result == 0) || ($result == "PASS") } {
      break;
    } 
    set current_time [clock seconds]
    set used_time [expr ($current_time - $begin_time)]
    ::MISC::ACTS_Dummy_Response {WARNING} "Check NAT Ping pass, Ping response time is $used_time seconds"        
  }
  ::CONSOLE::Wait {3}
<TCL_Block_End>
    
::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {LAN1_WKS} {root} {1234}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {dhclient -v -6 eth1}    
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {dhclient -v eth1}  
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2}

::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {LAN2_WKS} {root} {1234}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {dhclient -v -6 eth1}    
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {dhclient -v eth1}  
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2}

::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {DMZ_WKS} {root} {1234}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {dhclient -v -6 eth1}    
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {dhclient -v eth1}  
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2}
::CONSOLE::Wait {30}    
::CONSOLE::Check_WKS_Ping {LAN1_WKS} {eth1} {172.202.77.1} {PASS} {64} {3} {1} {1} {128}
::CONSOLE::Check_WKS_Ping {LAN1_WKS} {eth1} {168.95.1.1} {Don't Care} {64} {3} {1} {1} {128}
::CONSOLE::Check_WKS_Ping {LAN2_WKS} {eth1} {172.202.77.1} {PASS} {64} {3} {1} {1} {128}
::CONSOLE::Check_WKS_Ping {LAN2_WKS} {eth1} {168.95.1.1} {Don't Care} {64} {3} {1} {1} {128}
::CONSOLE::Check_WKS_Ping {DMZ_WKS} {eth1} {172.202.77.1} {PASS} {64} {3} {1} {1} {128}
::CONSOLE::Check_WKS_Ping {DMZ_WKS} {eth1} {168.95.1.1} {Don't Care} {64} {3} {1} {1} {128}
::CONSOLE::Wait {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     # IPv6 can't work well
   } else {
     ::CONSOLE::Check_WKS_Ping {LAN1_WKS} {eth1} {$NAT_WAN_IPv6_Address$} {PASS} {64} {3} {1} {1} {128} {IPv6}
   }
<TCL_Block_End>

# ======================= [Get device firmware version] ======================= #
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
<TCL_Block_Begin>
set ::DUT_FW_Version ""
set ::cmd_response  ""
::CONSOLE::CI_Capture_Response {} "sys atsh" 60 ::cmd_response
set ::resp_list [split $::cmd_response "\n"]
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 0]"
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 1]"
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 3]"
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 4]"
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 5]"
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 6]"
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 8]"
set ::DUT_FW_Version "$::DUT_FW_Version\n[lindex $::resp_list 9]"
<TCL_Block_End>
::CONSOLE::CI_Cmd {} {exit} {20}
    
-CaseEnd-



### ============================== [System] ============================== ###

%ENV-BAT|L1|L2|L3%
+CaseStart+
<< [Function-1] System >>
::CONSOLE::Local                     
-CaseEnd-









%ENV-L3%
+CaseStart+
< [Function-1] OPAL-13 Support "uptime" linux command >

# Check CLI command
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {uptime} {30} {} {load average}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}
 
-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-14 Support "mpstat" linux command >

# Check CLI command
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {mpstat} {30} {} {CPU}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-15 admin account can read romfile checksum by "sys atsh" >

# Check CLI command
::CONSOLE::Use_ZLD_WKS_Login {Local} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {sys atsh} {30} {Romfile Checksum} {}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-19368 Check admin account cannot use traceroute via Telnet/ SSH >

# For TMNL 
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Not support to configure MGMT Telnet/SSH service setting} {1}
   }
<TCL_Block_End>

# Set MGMT Any_WAN Interface
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Remote MGMT Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set MGMT Any_WAN Interface >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
   }
<TCL_Block_End>

# Enable Telnet/ SSH
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "Altibox" || "$PROJECT$" == "WIND" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Remote MGMT Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
     ::WEB::WebDrv_Click {id} {httpsLan_id_3_label} {20}
     ::WEB::WebDrv_Click {id} {httpsLan_id_4_label} {20}
     ::WEB::WebDrv_Click {id} {Maintenance_RemoteManagement_Apply} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >" 
   }
<TCL_Block_End>

# Login CPE via Telnet by admin account
#::CONSOLE::Open_Shell {Shell_1} {TELNET} {$LANIFDefaultAddress$} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
#::CONSOLE::CI_Cmd_Scan {} {traceroute 8.8.8.8\ &&\ /bin/sh} {30} {} {Error! Not support special character: `;&^<>$| ,Do nothing!!}
#::CONSOLE::Close_Shell {Shell_1}
#::CONSOLE::Wait {2}

# Login CPE via Telnet by admin account
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {LAN1_WKS} {root} {1234}
::CONSOLE::CI_Cmd_More {} {telnet $LANIFDefaultAddress$} {30} {$USER_LOGIN_NAME$} {30}
::CONSOLE::CI_Cmd {} {$USER_LOGIN_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {traceroute 8.8.8.8\ &&\ /bin/sh} {30} {} {Error! Not support special character: `;&^<>$| ,Do nothing!!}
::CONSOLE::Close_Shell {Shell_1_LAN1}
::CONSOLE::Wait {2}

# Login CPE via SSH by admin account
::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {LAN1_WKS} {root} {1234}
::CONSOLE::CI_Cmd {} {rm -rf /root/.ssh/known_hosts}
::CONSOLE::CI_Cmd {} {ssh $USER_LOGIN_NAME$@$LANIFDefaultAddress$}
::CONSOLE::CI_Cmd {} {$USER_LOGIN_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {traceroute 8.8.8.8\ &&\ /bin/sh} {30} {} {Error! Not support special character: `;&^<>$| ,Do nothing!!}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Close_Shell {Shell_1_LAN1}
::CONSOLE::Wait {2}

# Back to default setting
# Disable Telnet/ SSH 
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "Altibox" || "$PROJECT$" == "WIND" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Remote MGMT Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
     ::WEB::WebDrv_Click {id} {httpsLan_id_3_label} {20}
     ::WEB::WebDrv_Click {id} {httpsLan_id_4_label} {20}
     ::WEB::WebDrv_Click {id} {Maintenance_RemoteManagement_Apply} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >" 
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-22622 Support "genXML" command >

# Create TR-098 XML
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd {} {genXML tr98 axiros all /tmp/tr98.xml}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {cat /tmp/tr98.xml}
::CONSOLE::Wait_String {60} {</InternetGatewayDevice>}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}

# Create TR-181 XML
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd {} {genXML tr181 axiros all /tmp/tr181.xml}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {cat /tmp/tr181.xml}
::CONSOLE::Wait_String {60} {</Device>}
::CONSOLE::Wait {20}
::CONSOLE::CI_Cmd {} {exit}

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-18 Block Special Characters >

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Backup config file via supervisor account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Search "BlockSpecialChar", Check the default value to "BlockSpecialChar":false.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "BlockSpecialChar":false,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "BlockChar":"\"`'<>^$|&;",} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "BlockSpecialChar":false,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "BlockChar":"\"`'<>^$|&;",} {}
   }
<TCL_Block_End>

# Change the value to "BlockSpecialChar":true, "BlockChar":"\"`'<>"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "BlockSpecialChar":false,} {    "BlockSpecialChar":true,}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "BlockChar":"\"`'<>^$|&;",} {    "BlockChar":"\"`'<>",}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "BlockSpecialChar":false,} {    "BlockSpecialChar":true,}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "BlockChar":"\"`'<>^$|&;",} {    "BlockChar":"\"`'<>",}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Go System page to check BlockSpecialChar
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# GUI would block "`'<> and show warning message
::WEB::WebDrv_Set_Value {id} {sysDomainName} {\"`'<>} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]} {It is impossible to enter special characters.} {20} {PASS} {full}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}

# GUI would not block ^$|&; and can apply the setting
::WEB::WebDrv_Set_Value {id} {sysDomainName} {^$|&;} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {sysDomainName} {^$|&;} {20} {PASS}

# # Back to default setting
# Back to default System Domain Name
::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Back to default value of "BlockSpecialChar" and "BlockChar"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "BlockSpecialChar":true,} {    "BlockSpecialChar":false,}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "BlockChar":"\"`'<>",} {    "BlockChar":"\"`'<>^$|&;",}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "BlockSpecialChar":true,} {    "BlockSpecialChar":false,}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "BlockChar":"\"`'<>",} {    "BlockChar":"\"`'<>^$|&;",}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-19 Allow Character List >

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>
  
# Backup config file via supervisor account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Search "AllowFilter", Check the default value to "AllowFilter":true.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "AllowFilter":true,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "AllowCharList":" !#%()*+,-.\/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "AllowFilter":true,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "AllowCharList":" !#%()*+,-.\/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",} {}
   }
<TCL_Block_End>

# GUI would allow !#%()*+,- and can apply the setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {sysDomainName} {!#%()*+,-} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {sysDomainName} {!#%()*+,-} {20} {PASS}
::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change the value to "AllowCharList"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "AllowCharList":" !#%()*+,-.\/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",} {    "AllowCharList":" \/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "AllowCharList":" !#%()*+,-.\/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",} {    "AllowCharList":" \/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Go System page to check AllowCharList
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# GUI should not allow !#%()*+,-. and show warning message
::WEB::WebDrv_Set_Value {id} {sysDomainName} {!#%()*+,-.} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]} {It is impossible to enter special characters.} {20} {PASS} {full}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}

# # Back to default setting
# Back to default System Domain Name
::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Back to default value of "AllowCharList"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "AllowCharList":" \/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",} {    "AllowCharList":" !#%()*+,-.\/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "AllowCharList":" \/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",} {    "AllowCharList":" !#%()*+,-.\/0123456789:=?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]_abcdefghijklmnopqrstuvwxyz{}~",}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-20 Block Special Characters vs. Allow Character List >

# Case1: IF (BlockSpecialChar == true) --> The same as OPAL-18
# Case2: IF (BlockSpecialChar == false && AllowFilter == true) --> The same as OPAL-19
# The following is Case3: IF (BlockSpecialChar == false && AllowFilter == false)

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Backup config file via supervisor account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Search "AllowFilter", Check the default value to "AllowFilter":true.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "BlockSpecialChar":false,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "AllowFilter":true,} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "BlockSpecialChar":false,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "AllowFilter":true,} {}
   }
<TCL_Block_End>

# GUI should not allow $^& and show warning message
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {sysDomainName} {$^&} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]} {It is impossible to enter special characters.} {20} {PASS} {full}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change the value to "AllowFilter":false
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "AllowFilter":true,} {    "AllowFilter":false,}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "AllowFilter":true,} {    "AllowFilter":false,}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Go System page to check AllowFilter
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# GUI would allow $^& and can Apply the settings (GUI will NOT block any characters for all input field in pages.)
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {sysDomainName} {$^&} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {sysDomainName} {$^&} {20} {PASS}

# # Back to default setting
# Back to default System Domain Name
::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Back to default value of "AllowFilter"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "AllowFilter":false,} {    "AllowFilter":true,}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "AllowFilter":false,} {    "AllowFilter":true,}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

-CaseEnd-


%ENV-BAT%
+CaseStart+
< [Function-1] OPAL-25 Check auto-generate password mechanism >

# For WIND, not support auto-generate password mechanism
<TCL_Block_Begin>
if { "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {Not support auto-generate password mechanism} {1}             
} else {


# Generate Key

if { "$sysName$" == "VMG3312-T20A" || "$sysName$" == "PMG5622GA" || "$sysName$" == "VMG1312-B10D" || "$sysName$" == "VMG8924-B10D" } {
    set ::cpe_pwd [::TESTLINK::AutoGenKey {AutoGenSupervisorPassword} {$CPESN$}]
    ::MISC::ACTS_Dummy_Response {PASS} "Supervisor password is $::cpe_pwd"
} else {
    set ::cpe_pwd [::TESTLINK::AutoGenKey {New_AutoGenSupervisorPassword} {$CPESN$}]
    ::MISC::ACTS_Dummy_Response {PASS} "Supervisor password is $::cpe_pwd"
}


# Login GUI with supervisor account and the generate key.
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}

::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {5}
::WEB::WebDrv_Set_Value {id} {userpassword} "$::cpe_pwd" {5}
::WEB::WebDrv_Click {id} {loginBtn} {5} 

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {2}       
}
<TCL_Block_End>
-CaseEnd-



%ENV-BAT%
+CaseStart+
< [Function-1] OPAL-29 Check autogenerate random password mechnism for Admin account >

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# For WIND, not support auto-generate password mechanism
<TCL_Block_Begin>
if { "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {Not support auto-generate password mechanism} {1}             
} else {


# Backup config file via supervisor account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {2}

# Generate Key
set ::cpe_pwd [::TESTLINK::AutoGenKey {AutoGenAdminPassword} {$CPESN$}]
::MISC::ACTS_Dummy_Response {PASS} "Admin password is $::cpe_pwd"

# Reset default
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::Wait {2}                       
::CONSOLE::CI_Cmd {} {sys atcr reboot}
::CONSOLE::Wait {200}

# Login GUI with admin account and the generate key.
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {5}
::WEB::WebDrv_Set_Value {id} {userpassword} "$::cpe_pwd" {5}
::WEB::WebDrv_Click {id} {loginBtn} {5}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# User can see a skip button to choose not to change the already secured random password.
::WEB::WebDrv_Click {id} {cgPwSkip} {5}
::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {2}

# Reset default
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::Wait {2}                       
::CONSOLE::CI_Cmd {} {sys atcr reboot}
::CONSOLE::Wait {200}

# Login GUI with admin account and the generate key.
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {5}
::WEB::WebDrv_Set_Value {id} {userpassword} "$::cpe_pwd" {5}
::WEB::WebDrv_Click {id} {loginBtn} {5}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change admin's password and cancel quickstart
::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
::CONSOLE::Wait {1}                                                                                      
::WEB::WebDrv_Click {id} {cgPwApply} {20}
::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20} 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {2}

# Login with admin changed password, User cannot see a skip button to choose not to change.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {2}

# # Back to default setting
# Restore configuration
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }

::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete backup configuration
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
   
}
<TCL_Block_End>
       
-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-32 Check Firmware upgrade via http for WAN site >

# For TMNL 
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Not support to configure MGMT HTTP service setting} {1}
   }
<TCL_Block_End>

# Set HTTP service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTP Service >" [list {$HTTP_Mode=LAN_WAN} {$HTTP_Port=80}]

# For WIND & TE, Set HTTPS service by TR-069
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" || "$PROJECT$" == "TE" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTPS Service >" [list {$HTTPS_Mode=LAN_WAN} {$HTTPS_Port=443}]
   }
<TCL_Block_End>

# Capture CPE WAN IP
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
<TCL_Block_Begin>
set ::cmd_response ""                                                                   
set ::WAN_ip "0.0.0.0"

if { "$PON_Product$" == "no" } {
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_ETH_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_ETH_WAN_Interface$} {30} {inet addr} "$::WAN_ip"
   } else {
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_PON_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_PON_WAN_Interface$} {30} {inet addr} "$::WAN_ip"   
   }
<TCL_Block_End>

# Add routing table into PC
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {} {acts} {1234}
::CONSOLE::CI_Cmd_More {} {c:} {5} "route add $::WAN_ip mask 255.255.255.255 172.202.77.129 -p" {5} 
::CONSOLE::Close_Shell {DOS_Shell}
::CONSOLE::Wait {3}
    
::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
::CONSOLE::CI_Cmd {} "ifconfig eth1:4 172.202.77.129  netmask 255.255.255.252 up"
::CONSOLE::Wait {3}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}

# Get device image sequence number
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    # Get BootImage number
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
    ::CONSOLE::Wait {2}
    set ::cmd_response ""                                                                   
    set ::boot_image_1 ""
    ::CONSOLE::CI_Capture_Response {} "cat /tmp/bootImage" 5 ::cmd_response
    regexp {(.*?)# } $::cmd_response -> ::boot_image_1
} else {
    # Get device image sequence number
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}
}
<TCL_Block_End>

# Go to Firmware Upgrade page
::WEB::WebDrv_OpenWebSite "http://$::WAN_ip" {A1000}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_OpenWebSite "http://$::WAN_ip/AdvancedHiddenSetup" {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_File_Dialog {id} {filename} {$Tool File Path$\firmware/ras.bin} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Check TR-069 event code
#::USER_DEFINE::CheckTR069DeviceEventStrings {$CPEID$} {PASS} {1 BOOT} {4 VALUE CHANGE}

# Get device image sequence number
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    # Get BootImage number
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
    ::CONSOLE::Wait {2}
    set ::cmd_response ""                                                                   
    set ::boot_image_2 ""
    ::CONSOLE::CI_Capture_Response {} "cat /tmp/bootImage" 5 ::cmd_response
    regexp {(.*?)# } $::cmd_response -> ::boot_image_2
} else {
    # Get device image sequence number
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}
}
<TCL_Block_End>

# Check if FW upgrade success
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    if { $::boot_image_2 != $::boot_image_1 } {
      ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
    } else {
      ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old boot image number=$::boot_image_1, new boot image number=$::boot_image_2"
    }
} else {
    if { $::seq_num_2 > $::seq_num_1 } {
      ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
    } else {
      ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
    }
}
<TCL_Block_End>

# Check LAN_WKS can access Internet
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Ping Internet >"

# Back to default setting
# Set HTTP service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTP Service >" [list {$HTTP_Mode=LAN_ONLY} {$HTTP_Port=80}]

# For WIND & TE, Set HTTPS service by TR-069
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" || "$PROJECT$" == "TE" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTPS Service >" [list {$HTTPS_Mode=LAN_ONLY} {$HTTPS_Port=443}]
   }
<TCL_Block_End>

# Delete routing table by PC
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {} {acts} {1234}  
::CONSOLE::CI_Cmd_More {} {c:} {5} "route delete -p $::WAN_ip" {5} 
::CONSOLE::Close_Shell {DOS_Shell}
::CONSOLE::Wait {3}

# Reboot NAT_WKS
::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {90}

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-33 Check Firmware upgrade via https for LAN site >

# Set HTTPS service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTPS Service >" [list {$HTTPS_Mode=LAN_ONLY} {$HTTPS_Port=443}]

# Get device image sequence number
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    # Get BootImage number
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
    ::CONSOLE::Wait {2}
    set ::cmd_response ""                                                                   
    set ::boot_image_1 ""
    ::CONSOLE::CI_Capture_Response {} "cat /tmp/bootImage" 5 ::cmd_response
    regexp {(.*?)# } $::cmd_response -> ::boot_image_1
} else {
    # Get device image sequence number
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}
}
<TCL_Block_End>

# Go to Firmware Upgrade page
::WEB::WebDrv_OpenWebSite {https://$LANIFDefaultAddress$} {A1000}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_OpenWebSite {https://$LANIFDefaultAddress$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_File_Dialog {id} {filename} {$Tool File Path$/firmware/ras.bin} {20}
::CONSOLE::Wait {2}     
::WEB::WebDrv_Click {id} {upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Check TR-069 event code
#::USER_DEFINE::CheckTR069DeviceEventStrings {$CPEID$} {PASS} {1 BOOT} {4 VALUE CHANGE}

# Get device image sequence number
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    # Get BootImage number
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
    ::CONSOLE::Wait {2}
    set ::cmd_response ""                                                                   
    set ::boot_image_2 ""
    ::CONSOLE::CI_Capture_Response {} "cat /tmp/bootImage" 5 ::cmd_response
    regexp {(.*?)# } $::cmd_response -> ::boot_image_2
} else {
    # Get device image sequence number
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}
}
<TCL_Block_End>

# Check if FW upgrade success
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    if { $::boot_image_2 != $::boot_image_1 } {
      ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
    } else {
      ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old boot image number=$::boot_image_1, new boot image number=$::boot_image_2"
    }
} else {
    if { $::seq_num_2 > $::seq_num_1 } {
      ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
    } else {
      ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
    }
}
<TCL_Block_End>

# Check LAN_WKS can access Internet
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Ping Internet >"

-CaseEnd-                         



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-34 Check Firmware upgrade via https for WAN site >

# Set HTTPS service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTPS Service >" [list {$HTTPS_Mode=LAN_WAN} {$HTTPS_Port=443}]

# Capture CPE WAN IP
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
<TCL_Block_Begin>
set ::cmd_response ""                                                                   
set ::WAN_ip "0.0.0.0"

if { "$PON_Product$" == "no" } {
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_ETH_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_ETH_WAN_Interface$} {30} {inet addr} "$::WAN_ip"
   } else {
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_PON_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_PON_WAN_Interface$} {30} {inet addr} "$::WAN_ip"   
   }
<TCL_Block_End>

# Add routing table into PC
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {} {acts} {1234}
::CONSOLE::CI_Cmd_More {} {c:} {5} "route add $::WAN_ip mask 255.255.255.255 172.202.77.129 -p" {5} 
::CONSOLE::Close_Shell {DOS_Shell}
::CONSOLE::Wait {3}
    
::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
::CONSOLE::CI_Cmd {} "ifconfig eth1:4 172.202.77.129  netmask 255.255.255.252 up"
::CONSOLE::Wait {3}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}

# Go to Firmware Upgrade page
::WEB::WebDrv_OpenWebSite "https://$::WAN_ip" {A1000}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_OpenWebSite "https://$::WAN_ip/AdvancedHiddenSetup" {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_File_Dialog {id} {filename} {$Tool File Path$\firmware/ras.bin} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Check TR-069 event code
#::USER_DEFINE::CheckTR069DeviceEventStrings {$CPEID$} {PASS} {1 BOOT} {4 VALUE CHANGE}

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}

# Check if FW upgrade success
<TCL_Block_Begin>
if { $::seq_num_2 > $::seq_num_1 } {
  ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
} else {
  ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
}
<TCL_Block_End>

# Check LAN_WKS can access Internet
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Ping Internet >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTPS Service >"

# Delete routing table by PC
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {} {acts} {1234}  
::CONSOLE::CI_Cmd_More {} {c:} {5} "route delete -p $::WAN_ip" {5} 
::CONSOLE::Close_Shell {DOS_Shell}
::CONSOLE::Wait {3}

# Reboot NAT_WKS
::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {90}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-36 Check Firmware upgrade with restore to default settings >

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}

# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >" [list {$LAN_Start_IP=$LAN_IP_Prefix$33} {$LAN_End_IP=$LAN_IP_Prefix$180}] 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {sysSystemName} {TestHostName} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
    ::CONSOLE::Wait {1}
   } else {
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {TestDomainName} {20}
   } 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Enable "restore default settings" option then upgrade firmware
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_File_Dialog {id} {filename} {$Tool File Path$/firmware/ras.bin} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {reset_label} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {upload_btn} {20}

#<TCL_Block_Begin>
#if { "$sysName$" == "PMG5617-T20C" } {
#     ::CONSOLE::Wait_String {90} {BMT & BBT Init Success}
#   } elseif { "$sysName$" == "DX5601-B0" || "$sysName$" == "EX5601-T0" } { 
#     ::CONSOLE::Wait_String {90} {write image completely}
#   } elseif { "$Econet_Platform$" == "yes" } {
#     ::CONSOLE::Wait_String {90} {Doing firmware upgrade to tclinux}
#   } else {
#     ::CONSOLE::Wait_String {90} {write image success}
#   }
#<TCL_Block_End>

::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}

# Check if FW upgrade success
<TCL_Block_Begin>
if { $::seq_num_2 > $::seq_num_1 } {
  ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
} else {
  ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
}
<TCL_Block_End>

# Altibox first setting by command 
<TCL_Block_Begin>    
if { "$PROJECT$" == "Altibox" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {cfg mgmt_srv edit --Index 1 --Mode LAN_WAN}
     ::CONSOLE::Wait {10}
     ::CONSOLE::CI_Cmd {} {cfg lan edit --Name Default --EnableDHCP 1 --DHCPType DHCPServer --DHCP_MinAddress 192.168.10.2 --DHCP_MaxAddress 192.168.10.254 --DHCP_AutoReserveLanIp 0 --DHCP_LeaseTime 86400 --DNS_Type DNSProxy}
     ::CONSOLE::Wait {20}
     ::CONSOLE::CI_Cmd {} {exit}
   }
<TCL_Block_End>

# First login GUI with admin account
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } { 
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancel quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Edit ETH_MGNT WAN VLAN setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit4} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   
   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {passwordHint} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "WIND" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
         
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}       
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}
     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   
   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password to "zyxel1234" and cancel quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {2}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}     
   }
<TCL_Block_End>

# Set default ETH/PON WAN up
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set ETH Default Setting >" 
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set PON Default Setting >"
   }  
<TCL_Block_End>

# Check LAN DHCP start and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {64} {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {253} {20} {PASS}
   } else {
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {2} {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
     ::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {254} {20} {PASS}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}

# Check HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Check_Value {id} {sysSystemName} {Wind3 HUB - $sysName$} {20} {PASS}
    ::WEB::WebDrv_Check_Value {id} {sysDomainName} {wind3.hub} {20} {PASS}
} else {
    ::WEB::WebDrv_Check_Value {id} {sysSystemName} {$sysName$} {20} {PASS}
    ::WEB::WebDrv_Check_Value {id} {sysDomainName} {home} {20} {PASS}
}
<TCL_Block_End>

## Back to default setting
# Enable LAN IPv6
<TCL_Block_Begin>    
if { "$NewGUI$" == "yes" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN IPv6 >" [list {$LAN_IPv6=1}]
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_Click {id} {ls_apply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   }
<TCL_Block_End>
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    ::CONSOLE::Wait {5}

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End>

# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {10}

<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     # Change CPE TR-069 DataModel to TR-181
     ::CONSOLE::Local
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_More {} {cd /data} {30} {sed -i 's/TR-098/TR-181/g' zcfg_config.json} {30}
     ::CONSOLE::CI_Cmd {} {reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-37 Upgrade an illegal firmware >

# Go to Firmware Upgrade page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_File_Dialog {id} {filename} {$Tool File Path$/firmware/illegalras.bin} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {upload_btn} {20}
<TCL_Block_Begin>
if { "$sysName$" == "PMG5617-T20C" } {
     ::CONSOLE::Wait {20}
   } else {
     ::CONSOLE::Wait_String {40} {firmware upgrade: check upload file fail}
   }
<TCL_Block_End>
::CONSOLE::Wait {1}

# Click "Cancel" 
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[1]/button/span} {id} {alertCancelBtn} {20}
::CONSOLE::Wait {1}

# Check device firmware version
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Connect Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {10}
::WEB::WebDrv_Check_Text {id} {card_sysinfo_fwversion} {$FIRMWARE_VERSION$} {20} {PASS} {full}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check LAN_WKS can access Internet 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Ping Internet >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-38 Upgrade a firmware size is over product partition image >

# Go to Firmware Upgrade page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_File_Dialog {id} {filename} {$Tool File Path$/firmware/100ras.bin} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {upload_btn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

<TCL_Block_Begin>
::CONSOLE::Local
if { "$Econet_Platform$" == "yes" || "$sysName$" == "PMG5617-T20C" } {
    # Click OK button
    ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
   } else { 
    # Click Cancel button
    ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[1]/button/span} {id} {alertCancelBtn} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {1}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-39 [RomFile] Hide/Display Online Firmware Upgrade option and check Firmware Automatic Upgrade mechanism >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" && "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {For project, skip RomFile case} {1}
   }
<TCL_Block_End>

# Check WAN interface
<TCL_Block_Begin> 
if { "$PON_Product$" != "no" } {
     ::RUNNER::SkipCase {Can't unplug PON WAN by auto, so skip this case} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}

# Backup config file via supervisor account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Search "HideAutoOnlineFWUpgradeGUI", Check the default value to "HideAutoOnlineFWUpgradeGUI":true.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "HideAutoOnlineFWUpgradeGUI":true,} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "HideAutoOnlineFWUpgradeGUI":true,} {}
   }
<TCL_Block_End>

# Change the value to "HideAutoOnlineFWUpgradeGUI":false,
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "HideAutoOnlineFWUpgradeGUI":true,} {    "HideAutoOnlineFWUpgradeGUI":false,}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "HideAutoOnlineFWUpgradeGUI":true,} {    "HideAutoOnlineFWUpgradeGUI":false,}
   }
<TCL_Block_End>

# Get FW version and +1 (If DUT FW is V5.13(ABNY.2)b1, then fill in b2 version)
<TCL_Block_Begin>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Connect Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
set ::FIRMWARE_VERSION ""
::WEB::WebDrv_Get_Text {id} {card_sysinfo_fwversion} {::FIRMWARE_VERSION} {20}
set ::temp1 [string range $::FIRMWARE_VERSION 0 13]
#::MISC::ACTS_Dummy_Response {PASS} "$::temp1"
set ::temp2 [string range $::FIRMWARE_VERSION 14 14]
#::MISC::ACTS_Dummy_Response {PASS} "$::temp2"
set ::temp2 [incr ::temp2 1]
#::MISC::ACTS_Dummy_Response {PASS} "$::temp2"
set ::FIRMWARE_VERSION_next "$::temp1$::temp2"
::MISC::ACTS_Dummy_Response {PASS} "next FW version = $::FIRMWARE_VERSION_next"
::CONSOLE::Wait {1}
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Prepare info.txt and modify the content (please reference #86385 to download "info.txt" example)
file copy -force "$Tool File Path$/Include/info.txt" "C:/Users/acts/Downloads/info.txt"
::CONSOLE::Wait {1}
::TESTLINK::File_Modify {C:/Users/acts/Downloads/info.txt} {      <FWVersion>V5.30(ABIE.5)b2</FWVersion>} "      <FWVersion>$::FIRMWARE_VERSION_next</FWVersion>"
::CONSOLE::Wait {1}
::TESTLINK::File_Modify {C:/Users/acts/Downloads/info.txt} {      <ServerAddress>10.241.33.75</ServerAddress>} {      <ServerAddress>172.202.77.10</ServerAddress>}
::CONSOLE::Wait {1}                                                                                     
::TESTLINK::File_Modify {C:/Users/acts/Downloads/info.txt} {      <ServerPort>80</ServerPort>} {      <ServerPort>8080</ServerPort>}
::CONSOLE::Wait {1}
::TESTLINK::File_Modify {C:/Users/acts/Downloads/info.txt} {      <FWFilename>ras.bin</FWFilename>} {      <FWFilename>No_auth/ras.bin</FWFilename>}
::CONSOLE::Wait {3}

# Delete fileserver ras.bin , and put firmware bin file to fileserver
::CONSOLE::Open_Shell {Shell_FTP} {FTP} {172.202.77.10} {ACTS} {1234}
::CONSOLE::CI_Cmd_More {} {cd No_auth} {10}
::CONSOLE::CI_Cmd_More {} {dir} {10}
::CONSOLE::CI_Cmd_More {} {delete ras.bin} {60}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_More {} {delete info.txt} {60}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_More {} {bin} {10}
::CONSOLE::CI_Cmd_More {} {put D:\SPSBU_SWPQA\PQA_ACS\Tools\firmware\ras.bin} {60}
::CONSOLE::Wait {5}
::CONSOLE::CI_Cmd_More {} {put C:/Users/acts/Downloads/info.txt} {60}
::CONSOLE::Wait {5}
::CONSOLE::Close_Shell {Shell_FTP}

# Search config file "X_ZYXEL_Online_FW_Upgrade" and add 2 parameters 
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} "  \"X_ZYXEL_Online_FW_Upgrade\":\{" "  \"X_ZYXEL_Online_FW_Upgrade\":\{\n    \"Enable\":false,\n    \"FWInfoURL\":\"http://172.202.77.10:8080/No_auth/info.txt\""
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} "  \"X_ZYXEL_Online_FW_Upgrade\":\{" "  \"X_ZYXEL_Online_FW_Upgrade\":\{\n    \"Enable\":false,\n    \"FWInfoURL\":\"http://172.202.77.10:8080/No_auth/info.txt\""
   }
<TCL_Block_End>

# Restore configuration
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# After CPE reboot, check Firmware Upgrade page, GUI should add item "Do Online Firmware Upgrade" checkbox and an OK button
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firmware Upgrade Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Enable "CPE check for new upgrades on every boot up" and click OK
::WEB::WebDrv_Click {id} {CheckLatestFirmwareEnable_label} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {Submit_Firmware_Upgrade_En_btn} {20}
::CONSOLE::Wait {1}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Reboot CPE
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd {} {\n}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {120}

# Check TR-069 event code
#::USER_DEFINE::CheckTR069DeviceEventStrings {$CPEID$} {PASS} {1 BOOT} {4 VALUE CHANGE}

# Unplug WAN (Need unplug WAN and reset to default, or CPE would upgrade FW repeatedly)
::MISC::Enable_Network_Interface {WAN1} {Disable}
::MISC::Enable_xDSL_Line {1} {Disable}
::CONSOLE::Wait {200}

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}

# Check if FW upgrade success
<TCL_Block_Begin>
if { $::seq_num_2 > $::seq_num_1 } {
  ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
} else {
  ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
}
<TCL_Block_End>

## Back to default setting
# Reset CPE setting by command
<TCL_Block_Begin>
if { "$Platform$" == "OpenWRT" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} "$CPE_ROOT_PASSWORD$"
     ::CONSOLE::CI_Cmd {} {firstboot}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_WaitString {} {reboot} {Finish 5G UP} {300}
     ::MISC::ACTS_Dummy_Response {PASS} {end of device reboot}
     ::CONSOLE::Wait {150}
   } else {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcd}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcr reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

# Re-plug WAN
::MISC::Enable_Network_Interface {WAN1} {Enable}
::MISC::Enable_xDSL_Line {1} {Enable}

# Reset to default
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default.dlf}
   } else {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default_Project.dlf}
   }
<TCL_Block_End>
    
# Clear device record at Axiros server 
::USER_DEFINE::TR069ClearCPEsInACS
::CONSOLE::Wait {3}
    
# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {10}

# Clear Axiros server log record
::MISC::Include {$Tool File Path$/Include/Clear_axires_all_log.dlf}
::CONSOLE::Wait {3}

# Delete fileserver ras.bin , and put firmware bin file to fileserver
#::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
#::CONSOLE::Wait {2}
#::TESTLINK::CI_Cmd_More_No_Prompt {} {ftp 172.202.77.10} {10} {ACTS} {3} {1234} {3}
::CONSOLE::Open_Shell {Shell_FTP} {FTP} {172.202.77.10} {ACTS} {1234}
::CONSOLE::CI_Cmd_More {} {cd No_auth} {10}
::CONSOLE::CI_Cmd_More {} {dir} {10}
::CONSOLE::CI_Cmd_More {} {delete ras.bin} {60}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd_More {} {delete info.txt} {60}
::CONSOLE::Wait {2}
::CONSOLE::Close_Shell {Shell_FTP}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del info.txt} {30}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del info.txt} {30}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-40 Upgrade firmware via FTP >

# For WIND, need to use unencrypted fw to test, so skip this cases.
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     ::RUNNER::SkipCase {For WIND, need to use the other unencrypted fw to test, so skip this case.} {1}
   }
<TCL_Block_End>

# For TE, only support ftps (not ftp), so skip this cases.
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
     ::RUNNER::SkipCase {For TE, only support ftps (not ftp), auto environment not support ftps tool so skip this case.} {1}
   }
<TCL_Block_End>

# Set FTP service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT FTP Service >" [list {$FTP_Mode=LAN_ONLY} {$FTP_Port=21}]

# Get device image sequence number
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    # Get BootImage number
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
    ::CONSOLE::Wait {2}
    set ::cmd_response ""                                                                   
    set ::boot_image_1 ""
    ::CONSOLE::CI_Capture_Response {} "cat /tmp/bootImage" 5 ::cmd_response
    regexp {(.*?)# } $::cmd_response -> ::boot_image_1
} else {
    # Get device image sequence number
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}
}
<TCL_Block_End>

# Use admin account to login FTP and using command to upgrade firmware
::CONSOLE::Open_Shell {Shell_1} {FTP} {$LANIFDefaultAddress$} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
::CONSOLE::CI_Cmd_More {} {cd fw} {10} {bin} {10} 
::CONSOLE::CI_Cmd {} {put $Tool File Path$/firmware/ras.bin} 
::CONSOLE::Wait {200}
::CONSOLE::Close_Shell {Shell_1}

# Check TR-069 event code
#::USER_DEFINE::CheckTR069DeviceEventStrings {$CPEID$} {PASS} {1 BOOT} {4 VALUE CHANGE}

# Get device image sequence number
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    # Get BootImage number
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
    ::CONSOLE::Wait {2}
    set ::cmd_response ""                                                                   
    set ::boot_image_2 ""
    ::CONSOLE::CI_Capture_Response {} "cat /tmp/bootImage" 5 ::cmd_response
    regexp {(.*?)# } $::cmd_response -> ::boot_image_2
} else {
    # Get device image sequence number
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}
}
<TCL_Block_End>

# Check if FW upgrade success
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    if { $::boot_image_2 != $::boot_image_1 } {
      ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
    } else {
      ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old boot image number=$::boot_image_1, new boot image number=$::boot_image_2"
    }
} else {
    if { $::seq_num_2 > $::seq_num_1 } {
      ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
    } else {
      ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
    }
}
<TCL_Block_End>

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-50 Downgrade and Upgrade firmware via TR69 >
 
# Delete fileserver ras.bin and ras-0.bin, and put firmware bin file to fileserver
::CONSOLE::Open_Shell {Shell_FTP} {FTP} {172.202.77.10} {ACTS} {1234}
::CONSOLE::CI_Cmd_More {} {dir} {10}
::CONSOLE::CI_Cmd_More {} {delete ras.bin} {60}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd_More {} {delete ras-0.bin} {60}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd_More {} {bin} {10}
::CONSOLE::CI_Cmd_More {} {put D:\SPSBU_SWPQA\PQA_ACS\Tools\firmware\ras.bin} {60}
::CONSOLE::Wait {10}
::CONSOLE::CI_Cmd_More {} {put D:\SPSBU_SWPQA\PQA_ACS\Tools\firmware\ras-0.bin} {60}
::CONSOLE::Wait {10}
::CONSOLE::Close_Shell {Shell_FTP}

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}

# Downgrade firmware
::WEB::OpenWebSite {$ACSWEB$} {A10000}
::WEB::Set_value {textbox} {__ac_name_id} {$ACSUSERNAME$} {no} {} {}
::WEB::Set_value {password} {__ac_password_id} {$ACSPASSWORD$} {no} {} {}
::WEB::Click {submit} {Login} {no} {} {} {}
::WEB::Click {link} {CPEManager} {no} {} {} {}
::WEB::Click {link} {Managed CPEs} {no} {} {} {}
::WEB::Set_value {textbox} {cpeid_filter} {$CPEID$} {no} {} {}
::GUIAPP::Send_Enter
::WEB::Click {image} {Scenario} {no} {} {} {}
::WEB::Set_Select {select} {methodName} {Download} {no} {} {}
::WEB::Set_value {textarea} {params_box} {{'Username': 'ACTS', 'DelaySeconds': 5, 'TargetFileName': '', 'FailureURL': '', 'FileSize': 0, 'SuccessURL': '', 'URL': 'http://172.202.77.10:8080/acts/ras-0.bin', 'CommandKey': '', 'Password': '1234', 'FileType': '1 Firmware Upgrade Image'}} {no} {} {}
::WEB::Click {button} {btn_run_ajax_now} {no} {} {} {}
::CONSOLE::Wait {60}
::WEB::CloseWebSite {A10000}
::CONSOLE::Wait {180}
 
# Check event code
::USER_DEFINE::CheckTR069DeviceEventStrings {$CPEID$} {PASS} {M Download} {7 TRANSFER COMPLETE}

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}

# Check if FW upgrade success
<TCL_Block_Begin>
if { $::seq_num_2 > $::seq_num_1 } {
  ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
} else {
  ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
}
<TCL_Block_End>

# Check CPE can reply Connection Request
::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
<TCL_Block_Begin>
if { "$Data_Model$" == "TR098" } {
          ::USER_DEFINE::TR069Get_and_Check_DataModel {$CPEID$} {10} {PASS} {InternetGatewayDevice.ManagementServer.URL} {$ACSURL$} {}
   } else {
     ::USER_DEFINE::TR069Get_and_Check_DataModel {$CPEID$} {50} {PASS} {Device.ManagementServer.URL} {$ACSURL$} {}
   }
<TCL_Block_End>
::USER_DEFINE::CloseTR069ACS {}

# Check device firmware version
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {10}
::WEB::WebDrv_Check_Text {id} {card_sysinfo_fwversion} {$FIRMWARE_VERSION$} {20} {FAIL} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_1}

# Upgrade firmware
::WEB::OpenWebSite {$ACSWEB$} {A10000}
::WEB::Set_value {textbox} {__ac_name_id} {$ACSUSERNAME$} {no} {} {}
::WEB::Set_value {password} {__ac_password_id} {$ACSPASSWORD$} {no} {} {}
::WEB::Click {submit} {Login} {no} {} {} {}
::WEB::Click {link} {CPEManager} {no} {} {} {}
::WEB::Click {link} {Managed CPEs} {no} {} {} {}
::WEB::Set_value {textbox} {cpeid_filter} {$CPEID$} {no} {} {}
::GUIAPP::Send_Enter
::WEB::Click {image} {Scenario} {no} {} {} {}
::WEB::Set_Select {select} {methodName} {Download} {no} {} {}
::WEB::Set_value {textarea} {params_box} {{'Username': 'ACTS', 'DelaySeconds': 5, 'TargetFileName': '', 'FailureURL': '', 'FileSize': 0, 'SuccessURL': '', 'URL': 'http://172.202.77.10:8080/acts/ras.bin', 'CommandKey': '', 'Password': '1234', 'FileType': '1 Firmware Upgrade Image'}} {no} {} {}
::WEB::Click {button} {btn_run_ajax_now} {no} {} {} {}
::CONSOLE::Wait {60}
::WEB::CloseWebSite {A10000}
::CONSOLE::Wait {180}
 
# Check event code
::USER_DEFINE::CheckTR069DeviceEventStrings {$CPEID$} {PASS} {M Download} {7 TRANSFER COMPLETE}

# Get device image sequence number
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Get Device Image Sequence Number >" {} {::seq_num_2}

# Check if FW upgrade success
<TCL_Block_Begin>
if { $::seq_num_2 > $::seq_num_1 } {
  ::MISC::ACTS_Dummy_Response {PASS} {FW upgrade success}
} else {
  ::MISC::ACTS_Dummy_Response {FAIL} "FW upgarde failed. Old image sequence number=$::seq_num_1, new image sequence number=$::seq_num_2"
}
<TCL_Block_End>

# Check CPE can reply Connection Request
::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
<TCL_Block_Begin>
if { "$Data_Model$" == "TR098" } {
     ::USER_DEFINE::TR069Get_and_Check_DataModel {$CPEID$} {10} {PASS} {InternetGatewayDevice.ManagementServer.URL} {$ACSURL$} {}
   } else {
     ::USER_DEFINE::TR069Get_and_Check_DataModel {$CPEID$} {50} {PASS} {Device.ManagementServer.URL} {$ACSURL$} {}
   }
<TCL_Block_End>
::USER_DEFINE::CloseTR069ACS {}

# Check device firmware version
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {10}
::WEB::WebDrv_Check_Text {id} {card_sysinfo_fwversion} {$FIRMWARE_VERSION$} {20} {PASS} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Delete fileserver ras.bin and ras-0.bin
::CONSOLE::Wait {3}
::CONSOLE::Open_Shell {Shell_FTP} {FTP} {172.202.77.10} {ACTS} {1234}
::CONSOLE::CI_Cmd_More {} {dir} {10}
::CONSOLE::CI_Cmd_More {} {delete ras.bin} {60}
::CONSOLE::CI_Cmd_More {} {delete ras-0.bin} {60}
::CONSOLE::Close_Shell {Shell_FTP}

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-51 Configuration Backup >
   
# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del "Backup_Restore (1).conf"} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del "Backup_Restore (1)"} {30}
     ::CONSOLE::Wait {2} 
 }
<TCL_Block_End>

# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >" [list {$LAN_Start_IP=$LAN_IP_Prefix$33} {$LAN_End_IP=$LAN_IP_Prefix$180}]
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
set ::HostName ""
::WEB::WebDrv_Get_Value {id} {sysSystemName} {::HostName} {20}
::WEB::WebDrv_Set_Value {id} {sysSystemName} {TestHostName} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}
   } else {
    set ::DomainName ""
    ::WEB::WebDrv_Get_Value {id} {sysDomainName} {::DomainName} {20}
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {TestDomainName} {20}
   } 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
set ::ssid ""
::WEB::WebDrv_Get_Value {id} {wifi_ssid_000_11general11_000} {::ssid} {20}
::WEB::WebDrv_List_Select {id} {wifi_bandwidth_general} {text} {20MHz} {20}
::WEB::WebDrv_Click {id} {wifi_channel_general} {20}
::WEB::WebDrv_List_Select {id} {wifi_channel_general} {text} {9} {20}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {SSID_2.4G} {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20} 
::WEB::WebDrv_Set_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20} 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
          
# Go to Backup page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {5}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Search "password", Check the value to password is empty
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {                                            
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"Password":"$CPEPASSWORD$",} {} {FAIL}
	 ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"Password":"$USER_LOGIN_PASSWORD$",} {} {FAIL}
	 ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"Password":"$ACSAUTHPASSWORD$",} {} {FAIL}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"Password":"$CPEPASSWORD$",} {} {FAIL}
	 ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"Password":"$USER_LOGIN_PASSWORD$",} {} {FAIL}
	 ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"Password":"$ACSAUTHPASSWORD$",} {} {FAIL}
   }
<TCL_Block_End>

# Open GUI with https and backup configuration
::WEB::WebDrv_OpenWebSite {https://$LANIFDefaultAddress$} {A1000}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_OpenWebSite {https://$LANIFDefaultAddress$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {5}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} "$::HostName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} {$sysName$} {20}
}

if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}    
} elseif { "$PROJECT$" == "WIND" } { 
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} "$::DomainName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
} 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {wifi_bandwidth_general} {text} {20/40MHz} {20}
::WEB::WebDrv_Click {id} {wifi_channel_general} {20}
::WEB::WebDrv_List_Select {id} {wifi_channel_general} {text} {Auto} {20}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} "$::ssid" {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
          
-CaseEnd-



%ENV-BAT%
+CaseStart+
< [Function-1] OPAL-52 Reset to default >

# Reset to default
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {2}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Back to default setting
# Altibox first setting by command 
<TCL_Block_Begin>    
if { "$PROJECT$" == "Altibox" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {cfg mgmt_srv edit --Index 1 --Mode LAN_WAN}
     ::CONSOLE::Wait {10}
     ::CONSOLE::CI_Cmd {} {cfg lan edit --Name Default --EnableDHCP 1 --DHCPType DHCPServer --DHCP_MinAddress 192.168.10.2 --DHCP_MaxAddress 192.168.10.254 --DHCP_AutoReserveLanIp 0 --DHCP_LeaseTime 86400 --DNS_Type DNSProxy}
     ::CONSOLE::Wait {20}
     ::CONSOLE::CI_Cmd {} {exit}
   }
<TCL_Block_End>

# First login GUI with admin account
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } { 
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Edit ETH_MGNT WAN VLAN setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit4} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {passwordHint} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif {"$PROJECT$" == "WIND" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}       
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}
     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancel quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {2}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}     
   }
<TCL_Block_End>

# Set default ETH/PON WAN up
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set ETH Default Setting >" 
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set PON Default Setting >"
   }  
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}
<TCL_Block_Begin>
if { "$Econet_Platform$" == "yes" } {
     ::CONSOLE::Wait {10}
   }
<TCL_Block_End>

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End>

<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     # Change CPE TR-069 DataModel to TR-181
     ::CONSOLE::Local
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_More {} {cd /data} {30} {sed -i 's/TR-098/TR-181/g' zcfg_config.json} {30}
     ::CONSOLE::CI_Cmd {} {reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {5}


-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-53 Restore file >

# Get WiFi SSID
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
set ::ssid ""
::WEB::WebDrv_Get_Value {id} {wifi_ssid_000_11general11_000} {::ssid} {20}
::CONSOLE::Wait {2}

# Go to Backup/Restore page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:\Users\acts\Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:\Users\acts\Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Check configuration after restore file
# Check LAN DHCP start and end IP address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {33} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {180} {20} {PASS}
::CONSOLE::Wait {1}

# Check WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {SSID_2.4G} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {wifi_channel_general} {9} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {wifi_bandwidth_general} {20} {20} {PASS}
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}
   } else {
    ::WEB::WebDrv_Click {id} {wifi_wpa_psk_000_11general11_000_maskCheck} {20}
    ::WEB::WebDrv_Check_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20} {PASS}
   }   
<TCL_Block_End>
::CONSOLE::Wait {1}

# Check HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {sysSystemName} {TestHostName} {20} {PASS}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}
   } else {
    ::WEB::WebDrv_Check_Value {id} {sysDomainName} {TestDomainName} {20} {PASS}
    ::CONSOLE::Wait {1}
   }   
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} "$::HostName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} {$sysName$} {20}
}

if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}    
} elseif { "$PROJECT$" == "WIND" } { 
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} "$::DomainName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
} 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {wifi_bandwidth_general} {text} {20/40MHz} {20}
::WEB::WebDrv_Click {id} {wifi_channel_general} {20}
::WEB::WebDrv_List_Select {id} {wifi_channel_general} {text} {Auto} {20}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} "$::ssid" {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
 
# Open GUI with https and restore configuration
::WEB::WebDrv_OpenWebSite {https://$LANIFDefaultAddress$} {A1000}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_OpenWebSite {https://$LANIFDefaultAddress$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Backup/Restore page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:\Users\acts\Downloads/Backup_Restore (1).conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:\Users\acts\Downloads/Backup_Restore (1)} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# # Check configuration after restore file
# Check LAN DHCP start and end IP address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {33} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {180} {20} {PASS}
::CONSOLE::Wait {1}

# Check WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {SSID_2.4G} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {wifi_channel_general} {9} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {wifi_bandwidth_general} {20} {20} {PASS}
<TCL_Block_Begin>
if { "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}
   } else {
    ::WEB::WebDrv_Click {id} {wifi_wpa_psk_000_11general11_000_maskCheck} {20}
    ::WEB::WebDrv_Check_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20} {PASS}
   }   
<TCL_Block_End>
::CONSOLE::Wait {1}

# Check HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {sysSystemName} {TestHostName} {20} {PASS}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}
   } else {
    ::WEB::WebDrv_Check_Value {id} {sysDomainName} {TestDomainName} {20} {PASS}
    ::CONSOLE::Wait {1}
   }   
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# # Back to default setting
# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} "$::HostName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} {$sysName$} {20}
}

if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TE" } {
    ::CONSOLE::Wait {1}    
} elseif { "$PROJECT$" == "WIND" } { 
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} "$::DomainName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
} 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {wifi_bandwidth_general} {text} {20/40MHz} {20}
::WEB::WebDrv_Click {id} {wifi_channel_general} {20}
::WEB::WebDrv_List_Select {id} {wifi_channel_general} {text} {Auto} {20}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} "$::ssid" {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

 
# Delete backup file
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
	 ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del "Backup_Restore (1).conf"} {30}
   } else {
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
	 ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del "Backup_Restore (1)"} {30}
   }   
<TCL_Block_End>
::CONSOLE::Wait {5}
::CONSOLE::Close_Shell {DOS_Shell}

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-23263 Configuration Backup (Login via admin account) >

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >" [list {$LAN_Start_IP=$LAN_IP_Prefix$33} {$LAN_End_IP=$LAN_IP_Prefix$180}]
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
set ::HostName ""
::WEB::WebDrv_Get_Value {id} {sysSystemName} {::HostName} {20}
::WEB::WebDrv_Set_Value {id} {sysSystemName} {TestHostName} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
    ::CONSOLE::Wait {1}
   } else {
    set ::DomainName ""
    ::WEB::WebDrv_Get_Value {id} {sysDomainName} {::DomainName} {20}
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {TestDomainName} {20}
   } 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {5}
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
set ::ssid ""
::WEB::WebDrv_Get_Value {id} {wifi_ssid_000_11general11_000} {::ssid} {20}
::WEB::WebDrv_List_Select {id} {wifi_bandwidth_general} {text} {20MHz} {20}
::WEB::WebDrv_Click {id} {wifi_channel_general} {20}
::WEB::WebDrv_List_Select {id} {wifi_channel_general} {text} {9} {20}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {SSID_2.4G} {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20} 
::WEB::WebDrv_Set_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20} 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
          
# Go to Backup page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {5}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} "$::HostName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} {$sysName$} {20}
}

if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
    ::CONSOLE::Wait {1}    
} elseif { "$PROJECT$" == "WIND" } { 
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} "$::DomainName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
} 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {wifi_bandwidth_general} {text} {20/40MHz} {20}
::WEB::WebDrv_Click {id} {wifi_channel_general} {20}
::WEB::WebDrv_List_Select {id} {wifi_channel_general} {text} {Auto} {20}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} "$::ssid" {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Get WiFi SSID
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
set ::ssid ""
::WEB::WebDrv_Get_Value {id} {wifi_ssid_000_11general11_000} {::ssid} {20}
::CONSOLE::Wait {2}

# Go to Backup/Restore page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Check configuration after restore file
# Check LAN DHCP start and end IP address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {33} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {180} {20} {PASS}
::CONSOLE::Wait {1}

# Check WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {SSID_2.4G} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {wifi_channel_general} {9} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {wifi_bandwidth_general} {20} {20} {PASS}
::WEB::WebDrv_Click {id} {wifi_wpa_psk_000_11general11_000_maskCheck} {20}
::WEB::WebDrv_Check_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20} {PASS}
::CONSOLE::Wait {1}

# Check HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {sysSystemName} {TestHostName} {20} {PASS}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
    ::CONSOLE::Wait {1}
   } else {
    ::WEB::WebDrv_Check_Value {id} {sysDomainName} {TestDomainName} {20} {PASS}
    ::CONSOLE::Wait {1}
   }   
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set HostName and DomainName
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< System Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} "$::HostName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysSystemName} {$sysName$} {20}
}

if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
    ::CONSOLE::Wait {1}    
} elseif { "$PROJECT$" == "WIND" } { 
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} "$::DomainName" {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {sysDomainName} {home} {20}
} 
<TCL_Block_End>
::WEB::WebDrv_Click {id} {applySysBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {wifi_bandwidth_general} {text} {20/40MHz} {20}
::WEB::WebDrv_Click {id} {wifi_channel_general} {20}
::WEB::WebDrv_List_Select {id} {wifi_channel_general} {text} {Auto} {20}
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} "$::ssid" {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
          
# Delete backup file
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-26450 Bakup config file should not contain sip password >

# Check VoIP feature 
<TCL_Block_Begin>
if { "$VOIP_FEATURE$" == "no" } {
     ::RUNNER::SkipCase {Not support VoIP feature} {1}
   }
<TCL_Block_End>

# For MD project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Login DUT as admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Set SIP Account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< SIP Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_VoIP_SIPAccount_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {VoIP_SIPAccount_Edit1} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {SIP_Account_enable_label} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Set_Value {id} {SIP_Account_number} {12345} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {SIP_Account_auth_username} {12345} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {SIP_Account_auth_password} {12345} {20}
::CONSOLE::Wait {1}           
::WEB::WebDrv_Click {xpath} {//*[@id="popup"]/div/div[2]/div/div[2]/div[2]/button} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
::CONSOLE::Wait {20}

# Add a new admin account "root "
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Set_Value {id} {accountName} {root } {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {Abc12345} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Abc12345} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Login WebGUI with new admin account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {root } {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {Abc12345} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAAbc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {AAAbc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>

# Backup config
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# The backup config didn't content root, supervisor information
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"Username":"root"} {} {FAIL}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"Username":"supervisor"} {} {FAIL}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"AuthPassword"} {} {FAIL}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"Username":"root"} {} {FAIL}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"Username":"supervisor"} {} {FAIL}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"AuthPassword"} {} {FAIL}
   }
<TCL_Block_End>

# # Back to default setting
# Delete new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Restore VOIP Setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< SIP Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_VoIP_SIPAccount_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {VoIP_SIPAccount_Edit1} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {SIP_Account_enable_label} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {xpath} {//*[@id="popup"]/div/div[2]/div/div[2]/div[2]/button} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>
 
-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-60 Upgrade configure via FTP with admin account >

# For MD project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {\#143299 Can't access GUI after upgrade configuration file via FTP with TELMEX account} {1}
   }
<TCL_Block_End>

# For TMNL 
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Not support to configure MGMT FTP service setting} {1}
   }
<TCL_Block_End>

# Set wireless main SSID
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {rom-d-test-1} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set FTP service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT FTP Service >" [list {$FTP_Mode=LAN_ONLY} {$FTP_Port=21}]

# Upload config file by FTP
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Open_Shell {Shell_1} {FTP} {$LANIFDefaultAddress$} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
} else {
    ::CONSOLE::Open_Shell {Shell_1} {FTP} {$LANIFDefaultAddress$} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
}
<TCL_Block_End>
::CONSOLE::CI_Cmd_More {} {cd fw} {10} {bin} {10} 
::CONSOLE::CI_Cmd {} {put $Tool File Path$/config/CoNFIg1229}
::CONSOLE::Wait {200}
::CONSOLE::Close_Shell {Shell_1}

# Check wireless main SSID
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {rom-d-test-0} {20} {PASS} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-61 Upload ROM-D via FTP with admin account >    

# For MD project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {\#143299 Can't access GUI after upgrade configuration file via FTP with TELMEX account} {1}
   }
<TCL_Block_End>

# For TMNL 
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Not support to configure MGMT FTP service setting} {1}
   }
<TCL_Block_End>

# Set wireless main SSID
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {rom-d-test-1} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set FTP service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT FTP Service >" [list {$FTP_Mode=LAN_ONLY} {$FTP_Port=21}]

# Upload rom-d and config file by FTP
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Open_Shell {Shell_1} {FTP} {$LANIFDefaultAddress$} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
	 } else {
		::CONSOLE::Open_Shell {Shell_1} {FTP} {$LANIFDefaultAddress$} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
   }
<TCL_Block_End>
::CONSOLE::CI_Cmd_More {} {cd fw} {10} {bin} {10}
::CONSOLE::CI_Cmd {} {put $Tool File Path$/config/RoMEdAY224} 
::CONSOLE::CI_Cmd {} {put $Tool File Path$/config/CoNFIg1229}
::CONSOLE::Wait {200}
::CONSOLE::Close_Shell {Shell_1}

# Check wireless SSID by GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {rom-d-test-0} {20} {PASS} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set wireless SSID again
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {rom-d-test-2} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Reset to factory default
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}                                             
::WEB::WebDrv_CloseBrowser {A1000}
     
# Check wireless SSID by GUI again
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {rom-d-test-0} {20} {PASS} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Clear Rom-D
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_ROMD_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {romd_clean_btn} {20}
::CONSOLE::Wait {2}
     
# Reset to factory default
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_BackupRestore_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {2}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}                                             
::WEB::WebDrv_CloseBrowser {A1000}
     
# Altibox first setting by command 
<TCL_Block_Begin>    
if { "$PROJECT$" == "Altibox" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {cfg mgmt_srv edit --Index 1 --Mode LAN_WAN}
     ::CONSOLE::Wait {10}
     ::CONSOLE::CI_Cmd {} {cfg lan edit --Name Default --EnableDHCP 1 --DHCPType DHCPServer --DHCP_MinAddress 192.168.10.2 --DHCP_MaxAddress 192.168.10.254 --DHCP_AutoReserveLanIp 0 --DHCP_LeaseTime 86400 --DNS_Type DNSProxy}
     ::CONSOLE::Wait {20}
     ::CONSOLE::CI_Cmd {} {exit}
   }
<TCL_Block_End>

# First login GUI with admin account
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } { 
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Edit ETH_MGNT WAN VLAN setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit4} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {passwordHint} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "WIND" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
         
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}       
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
     ::CONSOLE::Wait {2}                      
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}
     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password to "zyxel1234" and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {2}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}     
   }
<TCL_Block_End>

# Set default ETH/PON WAN up
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set ETH Default Setting >" 
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set PON Default Setting >"
   }  
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Enable LAN IPv6
<TCL_Block_Begin>    
if { "$NewGUI$" == "yes" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN IPv6 >" [list {$LAN_IPv6=1}]
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_Click {id} {ls_apply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   }
<TCL_Block_End>
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    ::CONSOLE::Wait {5}

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End>
        
# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {5}

<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     # Change CPE TR-069 DataModel to TR-181
     ::CONSOLE::Local
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_More {} {cd /data} {30} {sed -i 's/TR-098/TR-181/g' zcfg_config.json} {30}
     ::CONSOLE::CI_Cmd {} {reboot}
     #::CONSOLE::Wait_String {200} {ztr69 daemon exists}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-62 Upgrade ROM-D via GUI >

# For MD project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Not support ROM-D function} {1}
   }
<TCL_Block_End>

# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >" [list {$LAN_Start_IP=$LAN_IP_Prefix$100} {$LAN_End_IP=$LAN_IP_Prefix$200}] 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {SSID_Test} {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20}
::WEB::WebDrv_Set_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Save Rom-D
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_ROMD_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {romd_save_btn} {20}
::CONSOLE::Wait {5}
    
# Reset to factory default
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_BackupRestore_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {2}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}                                             
::WEB::WebDrv_CloseBrowser {A1000}
    
# Check wireless SSID and password
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {SSID_Test} {20} {PASS}
::WEB::WebDrv_Click {id} {wifi_wpa_psk_000_11general11_000_maskCheck} {20}
::WEB::WebDrv_Check_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20} {PASS}

# Check LAN pool size
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {100} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {200} {20} {PASS}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Clear Rom-D
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_ROMD_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {romd_clean_btn} {20}
::CONSOLE::Wait {2}
     
# Reset to factory default
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_BackupRestore_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {2}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}                                             
::WEB::WebDrv_CloseBrowser {A1000}

# Altibox first setting by command 
<TCL_Block_Begin>    
if { "$PROJECT$" == "Altibox" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {cfg mgmt_srv edit --Index 1 --Mode LAN_WAN}
     ::CONSOLE::Wait {10}
     ::CONSOLE::CI_Cmd {} {cfg lan edit --Name Default --EnableDHCP 1 --DHCPType DHCPServer --DHCP_MinAddress 192.168.10.2 --DHCP_MaxAddress 192.168.10.254 --DHCP_AutoReserveLanIp 0 --DHCP_LeaseTime 86400 --DNS_Type DNSProxy}
     ::CONSOLE::Wait {20}
     ::CONSOLE::CI_Cmd {} {exit}
   }
<TCL_Block_End>
     
# First login GUI with admin account
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } { 
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Edit ETH_MGNT WAN VLAN setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit4} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {passwordHint} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "WIND" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
         
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}       
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}
     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {2}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}     
   }
<TCL_Block_End>

# Set default ETH/PON WAN up
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set ETH Default Setting >" 
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set PON Default Setting >"
   }  
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End> 
        
# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {5}

<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     # Change CPE TR-069 DataModel to TR-181
     ::CONSOLE::Local
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_More {} {cd /data} {30} {sed -i 's/TR-098/TR-181/g' zcfg_config.json} {30}
     ::CONSOLE::CI_Cmd {} {reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-63 Clear ROM-D via GUI >

# For MD project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Not support ROM-D function} {1}
   }
<TCL_Block_End>

# Set LAN start address and end address
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set LAN >" [list {$LAN_Start_IP=$LAN_IP_Prefix$100} {$LAN_End_IP=$LAN_IP_Prefix$200}] 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Set WiFi setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {wifi_ssid_000_11general11_000} {SSID_Test} {20}
::WEB::WebDrv_Click {id} {wifi_wpa_autogen_psk_000_11general11_000_label} {20}
::WEB::WebDrv_Set_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20}
::WEB::WebDrv_Click {id} {applyWifiBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Save Rom-D
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_ROMD_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {romd_save_btn} {20}
::CONSOLE::Wait {5}
     
# Reset to factory default
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_BackupRestore_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {2}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}                                             
::WEB::WebDrv_CloseBrowser {A1000}
   
# Check wireless SSID and password
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {SSID_Test} {20} {PASS}
::WEB::WebDrv_Click {id} {wifi_wpa_psk_000_11general11_000_maskCheck} {20}
::WEB::WebDrv_Check_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20} {PASS}
    
# Check LAN pool size and DNS
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {100} {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {200} {20} {PASS}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Clear Rom-D
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_ROMD_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {romd_clean_btn} {20}
::CONSOLE::Wait {2}
    
# Reset to factory default
::WEB::WebDrv_Click {id} {tab_Maintenance_Backup_BackupRestore_Tab} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {2}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}                                             
::WEB::WebDrv_CloseBrowser {A1000}

# Altibox first setting by command 
<TCL_Block_Begin>    
if { "$PROJECT$" == "Altibox" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {cfg mgmt_srv edit --Index 1 --Mode LAN_WAN}
     ::CONSOLE::Wait {10}
     ::CONSOLE::CI_Cmd {} {cfg lan edit --Name Default --EnableDHCP 1 --DHCPType DHCPServer --DHCP_MinAddress 192.168.10.2 --DHCP_MaxAddress 192.168.10.254 --DHCP_AutoReserveLanIp 0 --DHCP_LeaseTime 86400 --DNS_Type DNSProxy}
     ::CONSOLE::Wait {20}
     ::CONSOLE::CI_Cmd {} {exit}
   }
<TCL_Block_End>
    
# Check wireless SSID and password
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
} else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
}
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Wireless Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Value {id} {wifi_ssid_000_11general11_000} {SSID_Test} {20} {FAIL}
::WEB::WebDrv_Click {id} {wifi_wpa_psk_000_11general11_000_maskCheck} {20}
::WEB::WebDrv_Check_Value {id} {wifi_wpa_psk_000_11general11_000} {Test12345678} {20} {FAIL}
    
# Check LAN Pool size and DNS
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Home Networking Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
twapi::send_keys "{PGDN}"
::CONSOLE::Wait {2}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpstart_value_4} {100} {20} {FAIL}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_1} "$::LAN_IP_1" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_2} "$::LAN_IP_2" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_3} "$::LAN_IP_3" {20} {PASS}
::WEB::WebDrv_Check_Value {id} {a_ls_dhcpend_value_4} {200} {20} {FAIL}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
# First login GUI with admin account
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } { 
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Edit ETH_MGNT WAN VLAN setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit4} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {passwordHint} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "WIND" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
         
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}       
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}
     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {2}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}     
   }
<TCL_Block_End>

# Set default ETH/PON WAN up
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set ETH Default Setting >" 
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set PON Default Setting >"
   }  
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End>
        
# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {5}

<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     # Change CPE TR-069 DataModel to TR-181
     ::CONSOLE::Local
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_More {} {cd /data} {30} {sed -i 's/TR-098/TR-181/g' zcfg_config.json} {30}
     ::CONSOLE::CI_Cmd {} {reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-68 Reboot >

# Check TR-069 connection and let event code not be "1 Boot" before reboot CPE
::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
<TCL_Block_Begin>
if { "$Data_Model$" == "TR098" } {
     ::USER_DEFINE::TR069GetParameterValues {$CPEID$} {20} {InternetGatewayDevice.ManagementServer.} {URL} {$ACSURL$}
   } else {
     ::USER_DEFINE::TR069GetParameterValues {$CPEID$} {20} {Device.ManagementServer.} {URL} {$ACSURL$}
   }
<TCL_Block_End>
::USER_DEFINE::CloseTR069ACS {}

# Go to Reboot page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Reboot Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reboot_btn} {20}

# Check console display CPE reboot
#::CONSOLE::Local
#<TCL_Block_Begin>
#if { "$sysName$" == "PMG5617-T20C" } {
#     ::CONSOLE::Wait {1}
#   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$sysName$" == "EX5601-T0" || "$sysName$" == "EX5512-T0" } {
#     ::CONSOLE::Wait_String {40} {Hit any key to stop autoboot}   
#   } else {
#     ::CONSOLE::Wait_String {40} {is going down NOW}
#   }
#<TCL_Block_End>
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Login to ACS and check that the BOOT event be sent 
::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
::USER_DEFINE::Setup_Module_Path {$Tool File Path$/Include/DataModels}
::WEB::Click {link} {zyxel} {no} {} {} {}
::WEB::Click {link} {GetEventString} {no} {} {} {}
::WEB::Click {link} {Test} {no} {} {} {}
::WEB::Set_value {textbox} {argvars.value:records} {$CPEID$} {no} {} {}
::WEB::Click {submit} {Run Script} {no} {} {} {}
::WEB::Web_Check {1 BOOT} {div} {cpe_response} {no} {} {} {partial}
::USER_DEFINE::CloseTR069ACS {A1448875481470}
::CONSOLE::Wait {5}

# After DUT boot finish, check LAN side PC can NOT get IP address from WAN side.
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {LAN1_WKS} {root} {1234}
::CONSOLE::CI_Cmd {} {ifconfig eth1 down}
::CONSOLE::Wait {3}
::CONSOLE::CI_Cmd {} {ifconfig eth1 up}
::CONSOLE::Wait {10}
::CONSOLE::CI_Cmd_Scan {} {ifconfig} {30} {inet addr:$LAN_IP_Prefix$} {}
::CONSOLE::Close_Shell {Shell_1_LAN1}
::CONSOLE::Wait {2}

# Go to Reboot page, reboot CPE again
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Reboot Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reboot_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# After DUT boot finish, check LAN side PC can NOT get IP address from WAN side.
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Shell_1_LAN1} {SSH} {LAN1_WKS} {root} {1234}
::CONSOLE::CI_Cmd {} {ifconfig eth1 down}
::CONSOLE::Wait {3}
::CONSOLE::CI_Cmd {} {ifconfig eth1 up}
::CONSOLE::Wait {10}
::CONSOLE::CI_Cmd_Scan {} {ifconfig} {30} {inet addr:$LAN_IP_Prefix$} {}
::CONSOLE::Close_Shell {Shell_1_LAN1}
::CONSOLE::Wait {2}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-22495 Language Check >

# Check language list
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::CONSOLE::Wait {1}

::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
::CONSOLE::Wait {1}
::MISC::ACTS_Dummy_Response {PASS} {English}
::CONSOLE::Wait {1}
::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {it} {20}
::CONSOLE::Wait {1}
::MISC::ACTS_Dummy_Response {PASS} {Italiano}
::CONSOLE::Wait {1}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {tr} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {Turkey}
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {pt} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {Portugal}
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {cz} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {Cestina}
    ::CONSOLE::Wait {1}    
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {nl} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {Dutch}
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {ru} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {Russian}
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {fr} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {France}
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {de} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {Deutsch}
    ::CONSOLE::Wait {1}
    ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {es} {20}
    ::CONSOLE::Wait {1}
    ::MISC::ACTS_Dummy_Response {PASS} {Spanish}
    ::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_CloseBrowser {A1000}
::CONSOLE::Wait {5}

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-82 Using "Enter" key can login DUT >

# Reset to factory default
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}                                             
::WEB::WebDrv_CloseBrowser {A1000}

# Altibox first setting by command 
<TCL_Block_Begin>    
if { "$PROJECT$" == "Altibox" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {cfg mgmt_srv edit --Index 1 --Mode LAN_WAN}
     ::CONSOLE::Wait {10}
     ::CONSOLE::CI_Cmd {} {cfg lan edit --Name Default --EnableDHCP 1 --DHCPType DHCPServer --DHCP_MinAddress 192.168.10.2 --DHCP_MaxAddress 192.168.10.254 --DHCP_AutoReserveLanIp 0 --DHCP_LeaseTime 86400 --DNS_Type DNSProxy}
     ::CONSOLE::Wait {20}
     ::CONSOLE::CI_Cmd {} {exit}
   }
<TCL_Block_End>
       
# Login GUI by "Enter" key with admin account
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } { 
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Send_Enter
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancel quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Send_Enter
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Edit ETH_MGNT WAN VLAN setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit4} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Send_Enter
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Send_Enter
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {passwordHint} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "WIND" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Send_Enter
     ::CONSOLE::Wait {3}
         
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}       
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}

     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
	 # key in username=root or incorrect password, GUI should pop-out "The username or password is not correct or locked."
	 ::WEB::WebDrv_Set_Value {id} {username} {$CPE_ROOT_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPE_ROOT_PASSWORD$} {20}
     ::WEB::WebDrv_Send_Enter
	 ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
     ::CONSOLE::Wait {1}
	 
	 ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
	 ::WEB::WebDrv_Set_Value {id} {userpassword} {11112222} {20}
     ::WEB::WebDrv_Send_Enter
	 ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
     ::CONSOLE::Wait {1}
	 
	 # Press F5, password should still be hidden and not display clear-text.
	 twapi::send_keys {{F5}}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
	 ::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
	 ::CONSOLE::Wait {1}
	 
	 # key in correct admin username/password
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Send_Enter
     ::CONSOLE::Wait {1}
	 
	 # Press F5, The page only refresh. User should not login GUI without change password.
	 twapi::send_keys {{F5}}
	 ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
	 ::WEB::WebDrv_Check_Text {id} {cgPwApply} {Change password} {20} {PASS}
	 ::CONSOLE::Wait {2} 
     
     # Change admin's password and cancel quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Send_Enter
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}     
   }
<TCL_Block_End>

# Set default ETH/PON WAN up
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set ETH Default Setting >" 
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set PON Default Setting >"
   }  
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}
<TCL_Block_Begin>
if { "$Econet_Platform$" == "yes" } {
     ::CONSOLE::Wait {10}
   }
<TCL_Block_End>

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End>

# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {5}

<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     # Change CPE TR-069 DataModel to TR-181
     ::CONSOLE::Local
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_More {} {cd /data} {30} {sed -i 's/TR-098/TR-181/g' zcfg_config.json} {30}
     ::CONSOLE::CI_Cmd {} {reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-83 Change supervisor password >

# Set supervisor password to userdefined
<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     ::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
     ::USER_DEFINE::TR069SetParameterValues {$CPEID$} {Device.X_ZYXEL_LoginCfg.LogGp.1.} {Account.2.Password} {abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678901}
     ::USER_DEFINE::CloseTR069ACS {}
     ::CONSOLE::Wait {3}
   } elseif { "$PROJECT$" == "WIND" } {  
     ::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
     ::USER_DEFINE::TR069SetParameterValues {$CPEID$} {InternetGatewayDevice.X_ZYXEL_EXT.LoginCfg.LogGp.1.} {Account.2.Password} {AbcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678901}
     ::USER_DEFINE::CloseTR069ACS {}
     ::CONSOLE::Wait {3}          
   } else {
     ::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
     ::USER_DEFINE::TR069SetParameterValues {$CPEID$} {InternetGatewayDevice.X_ZYXEL_EXT.LoginCfg.LogGp.1.} {Account.2.Password} {abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678901}
     ::USER_DEFINE::CloseTR069ACS {}
     ::CONSOLE::Wait {3}
   }
<TCL_Block_End>

# Check login WebGUI with invalid password
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The password is not correct.} {20} {PASS} {full}
     ::CONSOLE::Wait {1}
   } elseif { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_CloseBrowser {A1000}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_CloseBrowser {A1000}
   }
<TCL_Block_End>

# Check login WebGUI with correct password
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Set_Value {id} {userpassword} {abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678901} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } elseif { "$PROJECT$" == "WIND" } {  
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {AbcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678901} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ012345678901} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Set supervisor password to default password
<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     ::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
     ::USER_DEFINE::TR069SetParameterValues {$CPEID$} {Device.X_ZYXEL_LoginCfg.LogGp.1.} {Account.2.Password} {$CPEPASSWORD$}
     ::USER_DEFINE::CloseTR069ACS {}
     ::CONSOLE::Wait {3}
   } else {
     ::USER_DEFINE::OpenTR069ACS {$ACSWEB$} {$ACSUSERNAME$} {$ACSPASSWORD$} {}
     ::USER_DEFINE::TR069SetParameterValues {$CPEID$} {InternetGatewayDevice.X_ZYXEL_EXT.LoginCfg.LogGp.1.} {Account.2.Password} {$CPEPASSWORD$}
     ::USER_DEFINE::CloseTR069ACS {}
     ::CONSOLE::Wait {3}
   }
<TCL_Block_End>

# Check login WebGUI with original password
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-84 Different command line interface >

# Login with root account by shell mode
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {zysh} {30} {ZySH>} {}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2}

# Login with supervisor account by shell mode
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPEUSERNAME$} {$CPEPASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {zysh} {30} {ZySH>} {}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2}

# Login with admin account by zysh mode "ZySH>"
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Local} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {zysh} {30} {Invalid input} {}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {2} 

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-85 [RomFile] Check parameter "HiddenPage" can control GUI privilege >

# Check VoIP feature 
<TCL_Block_Begin>
if { "$VOIP_FEATURE$" == "no" } {
     ::RUNNER::SkipCase {Not support VoIP feature} {1}
   }
<TCL_Block_End>

# For project
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" && "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {For project, skip RomFile case} {1}
   }
<TCL_Block_End>


# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Login GUI with supervisor account and Back up config file.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Search "X_ZYXEL_LoginCfg", Check the value to "X_ZYXEL_LoginCfg".
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {  "X_ZYXEL_LoginCfg"} {}                                               
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {  "X_ZYXEL_LoginCfg"} {}   
   }
<TCL_Block_End>
::CONSOLE::Wait {3}

# Add the value "HiddenPage":"CallHistory_id"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {                                            
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} "        \"Account\":\[" "        \"HiddenPage\":\"CallHistory_id\",\n        "Account":["
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} "        \"Account\":\[" "        \"HiddenPage\":\"CallHistory_id\",\n        \"Account\":\["
   }
<TCL_Block_End>
::CONSOLE::Wait {3}

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Check CallHistory_id button is hideden
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {h_menu_list} {20}
::CONSOLE::Wait {3}
::WEB::WebDrv_Click {linkText} {VoIP} {20}
::CONSOLE::Wait {3}
::WEB::WebDrv_Click {id} {CallHistory_id} {20} {FAIL}
::CONSOLE::Wait {3}

# Change the value to default "Page":""
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {                                            
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"HiddenPage":"CallHistory_id",} {<DELETE>}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"HiddenPage":"CallHistory_id",} {<DELETE>}
   }
<TCL_Block_End>

# Press F5
twapi::send_keys {{F5}}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Restore configuration
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End> 

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-86 [RomFile] Support config for Display/Hide Quick Start Wizard at GUI right-top >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" && "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {For project, skip RomFile case} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Reset CPE setting by command
<TCL_Block_Begin>
if { "$Platform$" == "OpenWRT" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} "$CPE_ROOT_PASSWORD$"
     ::CONSOLE::CI_Cmd {} {firstboot}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_WaitString {} {reboot} {Finish 5G UP} {300}
     ::MISC::ACTS_Dummy_Response {PASS} {end of device reboot}
     ::CONSOLE::Wait {150}
   } else {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcd}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcr reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

# Login GUI with supervisor account and Back up config file.
# For WIND, change language to ENG
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
   }
   ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Search "EnableQuickStart", Check the value to "EnableQuickStart":ture.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {                                            
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {            "EnableQuickStart":true,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {            "Username":"admin",} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {            "EnableQuickStart":true,} {}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {            "Username":"admin",} {}
   }
<TCL_Block_End>

# Search "EnableQuickStart", change the value to "EnableQuickStart":false.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {                                            
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {            "EnableQuickStart":true,} {            "EnableQuickStart":false,}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {            "EnableQuickStart":true,} {            "EnableQuickStart":false,}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# First Login GUI with default admin account and check Wizard button is hideden
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20} 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {cgPwSkip} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"  
#::WEB::WebDrv_Click {id} {qkSkip} {20}
#::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {h_menu_list} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {navbar_quickSetup} {20} {FAIL}
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {navbar_closeNav} {20}
::CONSOLE::Wait {2}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default.dlf}
     ::CONSOLE::Wait {3}
   } else {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default_Project.dlf}
     ::CONSOLE::Wait {3}
   }
<TCL_Block_End>

# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {10}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End> 


-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-87 Add admin account >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Add a new admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Set_Value {id} {accountName} {PQA123} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {12345} {20}
::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 8~64} {20} {PASS} {full}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 6~64} {20} {PASS} {full}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Add a new admin account again
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 

# Account name 'PQA123', GUI pop-up warning message
::WEB::WebDrv_Set_Value {id} {accountName} {PQA123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]/p} {This account already exists or is invalid!} {20} {PASS} {full}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {1}

# Account name 'supervisor', GUI pop-up warning message
::WEB::WebDrv_Set_Value {id} {accountName} {supervisor} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]/p} {This account already exists or is invalid!} {20} {PASS} {full}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {2}

# Account name 'root', GUI pop-up warning message
::WEB::WebDrv_Set_Value {id} {accountName} {root} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]/p} {This account already exists or is invalid!} {20} {PASS} {full}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {2}

::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_1} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Login WebGUI with new admin account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {PQA123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>    

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
 
-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-88 Add user account >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Add a new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Set_Value {id} {accountName} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Login WebGUI with new user account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-89 Check admin account password maximum length >

# Modify admin password to maximum length 64
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
# Click OK button to close pop up message
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {3}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Login GUI with admin new password
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}

<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {5}
     # Back to default setting
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     # Back to default setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {oldPasswd} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-90 Check user account password maximum length >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {No user account} {1}
   }
<TCL_Block_End>

# Add a new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Login GUI with user account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Modify user password to maximum length 64
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {abc123} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Set_Value {id} {newPasswd} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
# Click OK button to close pop up message
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {3}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Login GUI with user new password
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-91 Check admin account special character password >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "US" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Can't set special character password for admin account} {1}
   }
<TCL_Block_End>

# Change admin password with special character
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {A<a>^3^&$$} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {A<a>^3^&$$} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
# Click OK button to close pop up message
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Login GUI with admin new password
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {A<a>^3^&$$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {oldPasswd} {A<a>^3^&$$} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-92 Check user account special character password >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {No user account} {1}
   } elseif { "$PROJECT$" == "US" } { 
     ::RUNNER::SkipCase {Can't set special character password for admin account} {1}
   }
<TCL_Block_End>

# Add a new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
::WEB::WebDrv_Set_Value {id} {accountName} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Login GUI with user account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change user password with special character
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {A<a>^3^&$$} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {A<a>^3^&$$} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {<a>^3^&$$} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {<a>^3^&$$} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
# Click OK button to close pop up message
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Login GUI with user new password
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {A<a>^3^&$$} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {<a>^3^&$$} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-93 Add account number to maximum (admin and user) >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Add admin/user account number to maximum
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Admin account_1
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {Admin1} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa11111} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa11111} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a11111} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a11111} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {Administrator} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Admin account_2
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {Admin2} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa22222} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa22222} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a22222} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a22222} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {Administrator} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Admin account_3
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {Admin3} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa33333} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa33333} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a33333} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a33333} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {Administrator} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# User account_1
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {User1} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa11111} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa11111} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a11111} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a11111} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# User account_2
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {User2} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa22222} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa22222} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a22222} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a22222} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# User account_3
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {User3} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa33333} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa33333} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a33333} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a33333} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# User account_4
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {User4} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa44444} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa44444} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a44444} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a44444} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# WebGUI check
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount1_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount1_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount2_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount3_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount4_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount5_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount6_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::WEB::WebDrv_Check_Text {xpath} {//label[@id="userAccount7_label"][@class="custom-control custom-checkbox active "]/span} {} {20} {PASS} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-                                                                                               



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-94 Configure account retry times >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Can't set account retry times} {1}
   }
<TCL_Block_End>

# Check account retry times is 3 (default value), login GUI with invaild password
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {This username is invalid currently.} {20} {PASS} {partial}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {3}
::WEB::WebDrv_CloseBrowser {A1000}

# Set account retry times as 5
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {retryTime} {5} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check account retry times is 5, login GUI with invaild password
::CONSOLE::Wait {300}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {This username is invalid currently.} {20} {PASS} {partial}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {This username is invalid currently.} {20} {PASS} {partial}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {a11111} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {This username is invalid currently.} {20} {PASS} {partial}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {5}

# Check login GUI with correct password
::CONSOLE::Wait {300}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Set account retry times as 3
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {retryTime} {3} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-95 Configure account lock period times >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Can't set account lock period times} {1}
   }
<TCL_Block_End>

# Set account lock period times as 10
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {lockTime} {10} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >" 

# Check lock period times 600s, login GUI with invalid password
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {lock1234} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {lock1234} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {lock1234} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {This username is invalid currently.} {20} {PASS} {partial}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {5}

# Login GUI with correct password
::CONSOLE::Wait {600}
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Set account lock period times as 5
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {lockTime} {5} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-96 Configure account idle timeout >

# Add new account and set account idle timeout 300s
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

#::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
#::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
#::WEB::WebDrv_Set_Value {id} {idleTime} {5} {20}
#::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Set_Value {id} {accountName} {PQA123} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {12345} {20}
::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 8~64} {20} {PASS} {full}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 6~64} {20} {PASS} {full}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Set_Value {id} {idleTime} {5} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check account idle timeout 300s
#::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
#::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
#::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
#::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Login WebGUI with new admin account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {PQA123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>

# Check account idle timeout 300s
::CONSOLE::Wait {300}

<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } elseif { "$PROJECT$" == "WIND" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} 
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {3}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} 
     ::CONSOLE::Wait {2}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   }
<TCL_Block_End>

# Delete new account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-102 Check user create new account can do Edit/Delete >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Add new admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {admin123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} elseif { "$PROJECT$" == "TE" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Aa12345!} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aa12345!} {20}
    ::WEB::WebDrv_Set_Value {id} {passwordHint} {Aa12345!} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {Administrator} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
# Edit new admin account
::WEB::WebDrv_Click {id} {acc_editBtn1} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Aa123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aa123456} {20}
} elseif { "$PROJECT$" == "TE" } {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {Aa12345!} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Ab12345!} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Ab12345!} {20}
    ::WEB::WebDrv_Set_Value {id} {passwordHint} {Ab12345!} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {aa123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {aa123456} {20}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
# Delete new admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
# Add a new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Abcd1234} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Abcd1234} {20}
} elseif { "$PROJECT$" == "TE" } {
    ::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Abcd123!} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Abcd123!} {20}
    ::WEB::WebDrv_Set_Value {id} {passwordHint} {Abcd123!} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abcd123} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {abcd123} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Edit new user account 
::WEB::WebDrv_Click {id} {acc_editBtn1} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {Abcd1234} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Aa123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aa123456} {20}
} elseif { "$PROJECT$" == "TE" } {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {Abcd123!} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Abc1234!} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Abc1234!} {20}
    ::WEB::WebDrv_Set_Value {id} {passwordHint} {Abc1234!} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {oldPasswd} {abcd123} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {aa123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {aa123456} {20}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
# Delete new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-103 Logout button >

# Check logout button
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-104 Admin account should be denied to access default configuration setting >

# Check CLI command for admin account
::CONSOLE::Use_ZLD_WKS_Login {Local} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
#::CONSOLE::CI_Cmd_Scan {} {cat /data/zcfg_config.json} {30} {} {Invalid input}
::CONSOLE::CI_Cmd_Scan {} {cat /data/zcfg_config.json} {30} {} {>>>>> cat}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {5}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-105 Admin account can remove Administrator group and User group account >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Add admin & user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
# Add admin account 1
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {admin123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {Administrator} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
# Add admin account 2
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {admin321} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa123456} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {Administrator} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
# Add user account 1
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}    
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
# Add user account 2
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user321} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa123456} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}    
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Delete admin account 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
# Check deleted admin account 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {admin123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete another admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check deleted admin account  
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {admin321} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa123456} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_CloseBrowser {A1000}
 
# Delete user account 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check deleted user account   
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete another user account 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check deleted user account  
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user321} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa123456} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_CloseBrowser {A1000}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-106 Check user account can remove other User group account >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Add new user account by WebGUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}    
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Login user account and add another 2 user account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a123456} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {a123456} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20} 
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>  
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
# Create user account 1
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}    
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
# Create user account 2
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user321} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa123456} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a123456} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}    
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"    
    
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
# Delete user account 1
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
# Check deleted user account 1
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_CloseBrowser {A1000}
    
# Delete another user account 2
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check deleted user account 2 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user321} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa123456} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a123456} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_CloseBrowser {A1000}

# Back to default setting
# Delete user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-107 Check GUI when idle time is not over >

# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {240}
    
# After idle 4 minutes, go to other page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-109 Check if supervisor/admin/user/root passwords are encrypted with SHA-512 >

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>
   
# Login GUI with supervisor account and Back up config file.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Search "password", Check the value to password is empty
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {                                            
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "Password":"",} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "Password":"",} {}
   }
<TCL_Block_End>

# Check command
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::Wait {5}
::CONSOLE::CI_Cmd_Scan {} {cat /etc/passwd} {30} {supervisor:x:} {}
::CONSOLE::Wait {10}
::CONSOLE::CI_Cmd_Scan {} {cat /etc/shadow} {30} {supervisor:$6$} {}
::CONSOLE::CI_Cmd {} {exit}                     

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>


-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-110 Check GUI login password field behavior >

# Check GUI login password setting
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {5}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {5}
::CONSOLE::Wait {1}

# Check password field behavior
::WEB::WebDrv_Click {id} {userpassword} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {20} 
::CONSOLE::Wait {1}
twapi::send_keys {{UP}}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
::CONSOLE::Wait {3}

::WEB::WebDrv_Click {id} {userpassword} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {20} 
::CONSOLE::Wait {1}
twapi::send_keys {{DOWN}}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
::CONSOLE::Wait {3}

::WEB::WebDrv_Click {id} {userpassword} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {20} 
::CONSOLE::Wait {1}
twapi::send_keys {{RIGHT}}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
::CONSOLE::Wait {3}

::WEB::WebDrv_Click {id} {userpassword} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {20} 
::CONSOLE::Wait {1}
twapi::send_keys {{LEFT}}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
::CONSOLE::Wait {3}

::WEB::WebDrv_Click {id} {userpassword} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {20} 
::CONSOLE::Wait {1}
twapi::send_keys {{BACKSPACE}}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
::CONSOLE::Wait {3}

::WEB::WebDrv_Click {id} {userpassword} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {20} 
::WEB::WebDrv_Click {id} {username} {20}
#::WEB::WebDrv_Set_Value {id} {username} {1111} {20}
::WEB::WebDrv_Click {id} {username} {20}
::CONSOLE::Wait {1}
twapi::send_keys {{TAB}}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
::CONSOLE::Wait {3}

::WEB::WebDrv_Click {id} {userpassword} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {1111} {20} 
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {userpassword} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {userpassword} {} {20} {PASS}
::CONSOLE::Wait {3}

# Back to default setting
::WEB::WebDrv_CloseBrowser {A1000}


-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-111 Login test without password by F5 refresh >

# For WIND, no change password page by default, so skip this cases.
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     ::RUNNER::SkipCase {For WIND, no change password page by default, so skip this case.} {1}
   }
<TCL_Block_End>

# Reset to default button
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {id} {alertOKBtn} {20}                    
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Use admin login
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {5}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {5}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Admin login at the first time should change password page
::WEB::WebDrv_Check_Text {id} {cgPwApply} {Change password} {20} {PASS}
::CONSOLE::Wait {1}

# Press F5
twapi::send_keys {{F5}}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Check_Text {id} {cgPwApply} {Change password} {20} {PASS}
::CONSOLE::Wait {2}       
::WEB::WebDrv_Click {id} {cgPwSkip} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"  
#::WEB::WebDrv_Click {id} {qkSkip} {20}
#::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Reset device to factory defaults and change admin account password
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default.dlf}
     ::CONSOLE::Wait {3}
   } else {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default_Project.dlf}
     ::CONSOLE::Wait {3}
   }
<TCL_Block_End>

# For WIND, set Classification Setup edit VLAN ID Tag to unchange 
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" && "$Only_ETHWAN$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< QoS Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {tab_Network_QoS_ClassificationSetup_Tab} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     for { set i 0 } {$i <= 5} { incr i 1 } {
        ::WEB::WebDrv_Click {id} "Network_QoS_ClassificationSetup_Edit$i" {20}
        ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
        ::WEB::WebDrv_List_Select {id} {q_class_vlanActionSelect} {text} {Unchange} {20}
        ::CONSOLE::Wait {1}
        ::WEB::WebDrv_Click {id} {q_class_applyBtn}
        ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     }
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}             
   }
<TCL_Block_End>

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End> 
    
# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {10}


-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-112 Username account and passwords fields by default using serial number >

# Check VoIP feature 
<TCL_Block_Begin>
if { "$VOIP_FEATURE$" == "no" } {
     ::RUNNER::SkipCase {Not support VoIP feature} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Modify default WAN to PPPoE
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "10GPON" || "$PON_Product$" == "GPON" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_PON_BTN$} {$Encapsulation=PPPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
} else {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_ETH_BTN$} {$Encapsulation=PPPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
}
<TCL_Block_End> 

# Change SIP account 1 username
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< SIP Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {VoIP_SIPAccount_Edit1} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {SIP_Account_auth_username} {ChangeMe1} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {xpath} {//*[@id="popup"]/div/div[2]/div/div[2]/div[2]/button/span} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Backup configuration
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Modify config
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {        "Username":"acts",} {        "Username":"ZYXEL@SerialNumber",}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {                  "AuthUserName":"ChangeMe1",} {                  "AuthUserName":"XXXX_ZYXEL@SerialNumber",}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {        "Username":"acts",} {        "Username":"ZYXEL@SerialNumber",}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {                  "AuthUserName":"ChangeMe1",} {                  "AuthUserName":"XXXX_ZYXEL@SerialNumber",}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Login WebGUI 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check SIP account username will display ex:XXXX_S172V13003254
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< SIP Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {VoIP_SIPAccount_Edit1} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {SIP_Account_auth_username} "XXXX_$CPESN$" {20} {PASS}
::CONSOLE::Wait {1}

# Back to default SIP account username
::WEB::WebDrv_Set_Value {id} {SIP_Account_auth_username} {ChangeMe} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {xpath} {//*[@id="popup"]/div/div[2]/div/div[2]/div[2]/button/span} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check PPPoE username will display ex:S172V13003254
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {$BB_DEFAULT_BTN$} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Value {id} {bb_pppUsername} {$CPESN$} {20} {PASS}
::CONSOLE::Wait {1}

# Back to default PPPoE username
::WEB::WebDrv_Set_Value {id} {bb_pppUsername} {acts} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Back to default WAN to IPoE
<TCL_Block_Begin>
if { "$PON_Product$" == "10GPON" || "$PON_Product$" == "GPON" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_PON_BTN$} {$Encapsulation=IPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
} else {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_ETH_BTN$} {$Encapsulation=IPoE} {$IP_Mode=DualStack} {$VLAN=0} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
}
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-115 [RomFile] Hide/Display Change Password page after login >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" && "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {For project, skip RomFile case} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Reset CPE setting by command
<TCL_Block_Begin>
if { "$Platform$" == "OpenWRT" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} "$CPE_ROOT_PASSWORD$"
     ::CONSOLE::CI_Cmd {} {firstboot}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_WaitString {} {reboot} {Finish 5G UP} {300}
     ::MISC::ACTS_Dummy_Response {PASS} {end of device reboot}
     ::CONSOLE::Wait {150}
   } else {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcd}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcr reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

# Login with default admin password, notice that GUI will display "Change Password page". 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}

::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     
# Do not change passoword to login, just close browser.     
::WEB::WebDrv_CloseBrowser {A1000}

# Login GUI with supervisor account and Back up config file.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}

# Search "HideChangeDefault", Change the value to "HideChangeDefault":true,
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "HideChangeDefault":false,} {    "HideChangeDefault":true,}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "HideChangeDefault":false,} {    "HideChangeDefault":true,}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# When login with default admin account, GUI should NOT display change password page, User can use default random gen password to login GUI directly.
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}

#<TCL_Block_Begin>
#if { "$Econet_Platform$" == "yes" } {
    ::WEB::WebDrv_Click {id} {qkSkip} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
#   }
#<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# # Back to default setting
# Reset device to factory defaults and change admin account password
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default.dlf}
     ::CONSOLE::Wait {3}
   } else {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default_Project.dlf}
     ::CONSOLE::Wait {3}
   }
<TCL_Block_End>

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End> 
    
# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {10}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-116 [RomFile] Hide/Display Skip button in Change Password page >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" && "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {For project, skip RomFile case} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Reset CPE setting by command
<TCL_Block_Begin>
if { "$Platform$" == "OpenWRT" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} "$CPE_ROOT_PASSWORD$"
     ::CONSOLE::CI_Cmd {} {firstboot}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_WaitString {} {reboot} {Finish 5G UP} {300}
     ::MISC::ACTS_Dummy_Response {PASS} {end of device reboot}
     ::CONSOLE::Wait {150}
   } else {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcd}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {sys atcr reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

# Login GUI with supervisor account and Back up config file.
# For WIND, change language to ENG first
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}             
     ::WEB::WebDrv_Set_Value {id} {username} {$CPEUSERNAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
   }
   ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_End>
 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Search "ShowSkipBtnInChgDefPwdPage", Check the value to "ShowSkipBtnInChgDefPwdPage":false.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {            "ShowSkipBtnInChgDefPwdPage":true,} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {            "ShowSkipBtnInChgDefPwdPage":true,} {}
   }
<TCL_Block_End>

# Login with default admin password, GUI display change password page and display the "Skip" button 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}

#::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
#::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {cgPwSkip} {20} 
     
# Do not change passoword to login, just close browser.     
::WEB::WebDrv_CloseBrowser {A1000}

# Search "ShowSkipBtnInChgDefPwdPage", Change the value to "ShowSkipBtnInChgDefPwdPage":false
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {            "ShowSkipBtnInChgDefPwdPage":true,} {            "ShowSkipBtnInChgDefPwdPage":false,}
   } else {                                                                                                
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {            "ShowSkipBtnInChgDefPwdPage":true,} {            "ShowSkipBtnInChgDefPwdPage":false,}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Login with default admin password, GUI display change password page but the "Skip" item should be hidden 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {3}

::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {cgPwSkip} {20} {FAIL}

::WEB::WebDrv_CloseBrowser {A1000}

# # Back to default setting
# Reset device to factory defaults and change admin account password
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default.dlf}
     ::CONSOLE::Wait {3}
   } else {
     ::MISC::Include {$Tool File Path$/Include/Reset_to_Default_Project.dlf}
     ::CONSOLE::Wait {3}
   }
<TCL_Block_End>

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End> 
    
# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {10}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-117 [RomFile] Support remember password item will show or not in GUI login page >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" && "$PROJECT$" != "US" } {
     ::RUNNER::SkipCase {For project, skip RomFile case} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Login GUI with supervisor account and Back up config file.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Search "RememberPassword", Check the value to "RememberPassword":0.
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "RememberPassword":0,} {}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "RememberPassword":0,} {}
   }
<TCL_Block_End>

# GUI login page should not display "Remember password" with a checkbox 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Click {id} {remember_password_label} {20} {FAIL}
::WEB::WebDrv_CloseBrowser {A1000}

# Search "RememberPassword", Change the value to "RememberPassword":1
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "RememberPassword":0,} {    "RememberPassword":1,}
   } else {                                                                                                
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "RememberPassword":0,} {    "RememberPassword":1,}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# GUI login page should display "Remember password" with a checkbox 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Click {id} {remember_password_label} {20}
::WEB::WebDrv_CloseBrowser {A1000}

## Back to default setting
# Search "RememberPassword", Change the value to "RememberPassword":1
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {    "RememberPassword":1,} {    "RememberPassword":0,}
   } else {                                                                                                
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {    "RememberPassword":1,} {    "RememberPassword":0,}
   }
<TCL_Block_End>

# Restore configuration 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore.conf} {20}
   } else {
     ::WEB::WebDrv_File_Dialog {id} {filename} {C:/Users/acts/Downloads/Backup_Restore} {20}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {id} {restore_config_upload_btn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# GUI login page should not display "Remember password" with a checkbox 
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Click {id} {remember_password_label} {20} {FAIL}
::WEB::WebDrv_CloseBrowser {A1000}

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-26247 Support account remote access privilege >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "US" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Not support account remote access privilege function} {1}
   } elseif { "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Not support to configure MGMT HTTP/Telnet/FTP service setting} {1}
   }   
<TCL_Block_End>

# Add a new admin account, set remote privilege to "WAN"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {admin111} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {Administrator} {20}
::WEB::WebDrv_Click {id} {wan_access} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]/p} {Please check Remote Management Service for WAN as your need.} {20} {PASS} {full}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set MGMT Any_WAN Interface
<TCL_Block_Begin>
if { "$PROJECT$" != "Generic" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Remote MGMT Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set MGMT Any_WAN Interface >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
   }
<TCL_Block_End>

# Set HTTP/Telnet/FTP services by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTP Service >" [list {$HTTP_Mode=LAN_WAN} {$HTTP_Port=80}]
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT TELNET Service >" [list {$TELNET_Mode=LAN_WAN} {$TELNET_Port=23}]
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT FTP Service >" [list {$FTP_Mode=LAN_WAN} {$FTP_Port=21}]

# For WIND, need to enable https because Http will redirect to https from WAN side login.
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT HTTPS Service >" [list {$HTTPS_Mode=LAN_WAN} {$HTTPS_Port=443}]
}
<TCL_Block_End>

# Capture CPE WAN IP
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
<TCL_Block_Begin>
set ::cmd_response ""                                                                   
set ::WAN_ip "0.0.0.0"

if { "$PON_Product$" == "no" } {
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_ETH_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_ETH_WAN_Interface$} {30} {inet addr} "$::WAN_ip"
   } else {
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_PON_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_PON_WAN_Interface$} {30} {inet addr} "$::WAN_ip"   
   }
<TCL_Block_End>

# Add routing table into PC
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {} {acts} {1234}
::CONSOLE::CI_Cmd_More {} {c:} {5} "route add $::WAN_ip mask 255.255.255.255 172.202.77.129 -p" {5} 
::CONSOLE::Close_Shell {DOS_Shell}
::CONSOLE::Wait {3}
    
::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
::CONSOLE::CI_Cmd {} "ifconfig eth1:4 172.202.77.129 netmask 255.255.255.252 up"
::CONSOLE::Wait {3}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}
     
# Check WAN PC can access CPE by HTTP, LAN PC can't access
::WEB::WebDrv_OpenWebSite "http://$::WAN_ip" {A1000}
::CONSOLE::Wait {3}
::WEB::WebDrv_Set_Value {id} {username} {admin111} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check WAN PC can access CPE by Telnet, LAN PC can't access
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Check_WKS_Telnet_Exist {LAN1_WKS} {$LANIFDefaultAddress$} {admin111} {AAa12345} {FAIL}
    ::CONSOLE::Check_WKS_Telnet_Exist {WAN_WKS} "$::WAN_ip" {admin111} {AAa12345} {PASS}
} else {
    ::CONSOLE::Check_WKS_Telnet_Exist {LAN1_WKS} {$LANIFDefaultAddress$} {admin111} {abc123} {FAIL}
    ::CONSOLE::Check_WKS_Telnet_Exist {WAN_WKS} "$::WAN_ip" {admin111} {abc123} {PASS}
}
<TCL_Block_End>
::CONSOLE::Wait {2}

# Check WAN PC can access CPE by FTP, LAN PC can't access
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Check_WKS_FTP_Connect {LAN1_WKS} {$LANIFDefaultAddress$} {admin111} {AAa12345} {FAIL}
    ::CONSOLE::Check_WKS_FTP_Connect {WAN_WKS} "$::WAN_ip" {admin111} {AAa12345} {PASS}
} else {
    ::CONSOLE::Check_WKS_FTP_Connect {LAN1_WKS} {$LANIFDefaultAddress$} {admin111} {abc123} {FAIL}
    ::CONSOLE::Check_WKS_FTP_Connect {WAN_WKS} "$::WAN_ip" {admin111} {abc123} {PASS}
}
<TCL_Block_End>
::CONSOLE::Wait {2}

# Set account admin111 remote privilege to "LAN/WAN"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    # For WIND, not support "LAN/WAN" remote privilege setting
    ::CONSOLE::Wait {2}
} else {

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {acc_editBtn1} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {lan_wan_access} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check LAN/WAN PC can access CPE by HTTP
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {admin111} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {abc123} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

::WEB::WebDrv_OpenWebSite "http://$::WAN_ip" {A1000}
::CONSOLE::Wait {3}
::WEB::WebDrv_Set_Value {id} {username} {admin111} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {abc123} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check LAN/WAN PC can access CPE by Telnet
::CONSOLE::Check_WKS_Telnet_Exist {LAN1_WKS} {$LANIFDefaultAddress$} {admin111} {abc123} {PASS}
::CONSOLE::Check_WKS_Telnet_Exist {WAN_WKS} "$::WAN_ip" {admin111} {abc123} {PASS}
::CONSOLE::Wait {2}

# Check LAN/WAN PC can access CPE by FTP
::CONSOLE::Check_WKS_FTP_Connect {LAN1_WKS} {$LANIFDefaultAddress$} {admin111} {abc123} {PASS}
::CONSOLE::Check_WKS_FTP_Connect {WAN_WKS} "$::WAN_ip" {admin111} {abc123} {PASS}
::CONSOLE::Wait {2}
}
<TCL_Block_End>

# Back to default setting
# Delete new admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Delete routing table by PC
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {} {acts} {1234}  
::CONSOLE::CI_Cmd_More {} {c:} {5} "route delete -p $::WAN_ip" {5} 
::CONSOLE::Close_Shell {DOS_Shell}
::CONSOLE::Wait {3}

# Reboot NAT_WKS
::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {NAT} {root} {1234}
::CONSOLE::Wait {2}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {90}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-27023 Check supervisor information from user's backup config >

# For MD project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Delete configuration in Downloads folder
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {2}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Add a new admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Set_Value {id} {accountName} {root } {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# Login WebGUI with new admin account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {root } {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>

# Backup config
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {backup_config_backup_btn} {20}
::CONSOLE::Wait {10}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# The backup config didn't content root, supervisor information
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"Username":"root"} {} {FAIL}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore.conf} {"Username":"supervisor"} {} {FAIL}
   } else {
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"Username":"root"} {} {FAIL}
     ::TESTLINK::File_Modify {C:/Users/acts/Downloads/Backup_Restore} {"Username":"supervisor"} {} {FAIL}
   }
<TCL_Block_End>

# # Back to default setting
# Delete new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Delete backup configuration
<TCL_Block_Begin>
if { "$US_Generic$" == "yes" } {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore.conf} {30}
     ::CONSOLE::Wait {5}
   } else {
     ::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
     ::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:/Users/acts/Downloads"} {10} {del Backup_Restore} {30}
     ::CONSOLE::Wait {5}
   }
<TCL_Block_End>
 
-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-35466 Add account begin with "admin" and reboot, the new password cannot login device >

# For MD project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Add a new admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Set_Value {id} {accountName} {admin123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {5}

# Reboot CPE
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd {} {\n}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {200}
<TCL_Block_Begin>
if { "$sysName$" == "PMG5617-T20C" } {
     ::CONSOLE::Wait {20}
   }
<TCL_Block_End>

# Check new admin account can login WebGUI
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {admin123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

## Back to default setting
# Check default admin account can login WebGUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Delete new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
 
-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-118 For OPAL platform, there is no User account by default, and end user can add/delete manually >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Can't add new admin/user account} {1}
   }
<TCL_Block_End>

# Check no user account  
#::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
#::WEB::WebDrv_Set_Value {id} {username} {user} {20}
#::WEB::WebDrv_Set_Value {id} {userpassword} {1234} {20}
#::WEB::WebDrv_Click {id} {loginBtn} {20}
#::CONSOLE::Wait {2}
#<TCL_Block_Begin>
#if { "$sysName$" == "PX7511-B0" } {
#     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
#   } else {
#     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
#   }
#<TCL_Block_End>
#::CONSOLE::Wait {2}
#::WEB::WebDrv_CloseBrowser {A1000}

# Add a new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {AAa12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {a12345} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {a12345} {20}
}
<TCL_Block_End>

::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check 2nd account is "user123" (Check no other default user account)
::WEB::WebDrv_Check_Text {xpath} {//*[@id="Maintenance_UserAccount_Table"]/tbody/tr[2]/td[3]} {user123} {20} {PASS} {full}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Delete new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check deleted user account   
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {AAa12345} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {a12345} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$sysName$" == "PX7511-B0" } {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {id} {zypswd} {The username or password is not correct or locked.} {20} {PASS} {full}   
   }
<TCL_Block_End>
::CONSOLE::Wait {2}
::WEB::WebDrv_CloseBrowser {A1000}

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-119 The user account must to show change password page when user didn't change default password >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "WIND"} {
     ::RUNNER::SkipCase {Not support to show change password page} {1}
   }
<TCL_Block_End>

# Go to Backup/Restore page, reset to default
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Backup/Restore Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {reset_config_reset_btn} {20}
::CONSOLE::Wait {2}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {200}
::WEB::WebDrv_CloseBrowser {A1000}

# Altibox first setting by command 
<TCL_Block_Begin>    
if { "$PROJECT$" == "Altibox" } {
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {2}
     ::CONSOLE::CI_Cmd {} {cfg mgmt_srv edit --Index 1 --Mode LAN_WAN}
     ::CONSOLE::Wait {10}
     ::CONSOLE::CI_Cmd {} {cfg lan edit --Name Default --EnableDHCP 1 --DHCPType DHCPServer --DHCP_MinAddress 192.168.10.2 --DHCP_MaxAddress 192.168.10.254 --DHCP_AutoReserveLanIp 0 --DHCP_LeaseTime 86400 --DNS_Type DNSProxy}
     ::CONSOLE::Wait {20}
     ::CONSOLE::CI_Cmd {} {exit}
   }
<TCL_Block_End>

# First login GUI with admin account
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } { 
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20} {Don't Care}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Edit ETH_MGNT WAN VLAN setting
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit4} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

   } elseif { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     # Change language to ENG
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_List_Select {id} {exampleFormControlSelect1} {option_value} {en} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} {Don't Care}
     ::CONSOLE::Wait {3}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Change admin's password
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
     ::WEB::WebDrv_Set_Value {id} {passwordHint} {$USER_LOGIN_PASSWORD$} {20}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}
     
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   } else {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$USER_LOGIN_DEFAULT_PASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::CONSOLE::Wait {3}
     
     # Change admin's password and cancle quickstart (check GUI show "Change Password" page)
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {zyxel1234} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {zyxel1234} {20}
     ::CONSOLE::Wait {2}                                                                                      
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}
     ::WEB::WebDrv_Click {id} {qkSkip} {20}
     ::WEB::WebDrv_Wait_VMG_Loading {xpath} {//div[@class="loader-spinner"]} {20}     
   }
<TCL_Block_End>

# Set default ETH/PON WAN up
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set ETH Default Setting >" 
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set PON Default Setting >"
   }  
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
::CONSOLE::Wait {15}

# For Altibox, set WAN setting for TR-069 connection
<TCL_Block_Begin>
if { "$PROJECT$" == "Altibox" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {Network_Broadband_Broad_Edit2} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     # Enable VLAN
     set ::target_value ""
     set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"bb_enblVlan\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
     if { ($::temp != 0) && ( $::temp != "PASS") } {
	    ::WEB::WebDrv_Click {id} {bb_enblVlan} {20}
	    ::CONSOLE::Wait {1}
     }
     
     if { "$PON_Product$" == "no" } {
      ::CONSOLE::Get_Network_VLAN_ID {WAN2} {::vlan_id}
     } else { 
      ::CONSOLE::Get_GPON_VLAN_ID {GPON2} {::vlan_id}
     }
     ::WEB::WebDrv_Set_Value {id} {bb_vlanId} "$::vlan_id" {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {id} {WANInterface_btnsave} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}
   }
<TCL_Block_End>

# Configure device's ACS URL by console
::MISC::Include {$Tool File Path$/Include/SetTR-069byConsole.dlf}
::CONSOLE::Wait {5}

<TCL_Block_Begin>
if { "$Data_Model$" == "TR181" } {
     # Change CPE TR-069 DataModel to TR-181
     ::CONSOLE::Local
     ::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
     ::CONSOLE::Wait {3}
     ::CONSOLE::CI_Cmd_More {} {cd /data} {30} {sed -i 's/TR-098/TR-181/g' zcfg_config.json} {30}
     ::CONSOLE::CI_Cmd {} {reboot}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>

# Add a new user account 
<TCL_Block_Begin>
if { "$PROJECT$" != "TMNL" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
    ::WEB::WebDrv_Click {id} {adduser} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abcd123} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {abcd123} {20}
    ::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
    ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
    # Login with new user account
    ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
    ::WEB::WebDrv_Set_Value {id} {username} {user123} {20}
    ::WEB::WebDrv_Set_Value {id} {userpassword} {abcd123} {20}
    ::WEB::WebDrv_Click {id} {loginBtn} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    
    # Change user's password to 'zyxel1234' (check GUI show "Change Password" page)
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {zyxel1234} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {zyxel1234} {20}                                                                                      
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
    # Delete new user account
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
    ::CONSOLE::Wait {1}
    ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
   }
<TCL_Block_End>

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-120 Check the user account password length must include 6 to 64 characters, include 0-9 and a-z >

# Modify admin password to a1234, check pop up error message
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {oldPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {a1234} {20}
::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {           
     ::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]/p} {The password must have 10 to 64 characters, count at least one numerical character, a lowercase letter and a capital letter.} {20} {PASS} {full}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
   } elseif { "$PROJECT$" == "WIND" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 8~64} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 6~64} {20} {PASS} {full}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}

# Modify admin password to maximum length 64 (only 0-9), check pop up error message 
::WEB::WebDrv_Set_Value {id} {newPasswd} {1234567890123456789012345678901234567890123456789012345678901234} {20}
::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]/p} {The password must have 10 to 64 characters, count at least one numerical character, a lowercase letter and a capital letter.} {20} {PASS} {full}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
   } elseif { "$PROJECT$" == "WIND" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one upper case letter, one lower case letter and one number.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one numeric character and one alphanumeric character.} {20} {PASS} {full}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}

# Modify admin password to maximum length 64 (only a-z), check pop up error message
::WEB::WebDrv_Set_Value {id} {newPasswd} {abcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcd} {20}
::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]/p} {The password must have 10 to 64 characters, count at least one numerical character, a lowercase letter and a capital letter.} {20} {PASS} {full}
     ::CONSOLE::Wait {1}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
   } elseif { "$PROJECT$" == "WIND" } {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one upper case letter, one lower case letter and one number.} {20} {PASS} {full}
   } else {
     ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one numeric character and one alphanumeric character.} {20} {PASS} {full}
   }
<TCL_Block_End>
::CONSOLE::Wait {2}

# Modify admin password to maximum length 64 (include 0-9 & a-z)
::WEB::WebDrv_Set_Value {id} {newPasswd} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
     ::WEB::WebDrv_CloseBrowser {A1000}
     ::CONSOLE::Wait {5}
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000} 
} 
<TCL_Block_End>

# Login GUI with admin new password
::WEB::WebDrv_Set_Value {id} {username} {$USER_LOGIN_NAME$} {20}
::WEB::WebDrv_Set_Value {id} {userpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Click {id} {loginBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
   }
<TCL_Block_End>

# Add a new user account and set user password to a1234, check pop up error message
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" || "$PROJECT$" == "US" || "$PROJECT$" == "WIND" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     ::WEB::WebDrv_Click {id} {adduser} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {accountName} {user_test} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {a1234} {20}
     ::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
     if { "$PROJECT$" == "WIND" } {
        ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 8~64} {20} {PASS} {full}
     } else {
        ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {Length of password is from 6~64} {20} {PASS} {full}
     }
     ::CONSOLE::Wait {2}

     # Set user password to maximum length 64 (only 0-9), check pop up error message
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {1234567890123456789012345678901234567890123456789012345678901234} {20}
     ::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
     if { "$PROJECT$" == "WIND" } {
        ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one upper case letter, one lower case letter and one number.} {20} {PASS} {full}
     } else {
        ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one numeric character and one alphanumeric character.} {20} {PASS} {full}
     }
     ::CONSOLE::Wait {2}

     # Set user password to maximum length 64 (only a-z), check pop up error message
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {abcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcdefghijabcd} {20}
     ::WEB::WebDrv_Click {id} {verifyNewpassword} {20}
     if { "$PROJECT$" == "WIND" } {
        ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one upper case letter, one lower case letter and one number.} {20} {PASS} {full}
     } else {
        ::WEB::WebDrv_Check_Text {xpath} {//div[@class="memo"]} {The password must contain at least one numeric character and one alphanumeric character.} {20} {PASS} {full}
     }
     ::CONSOLE::Wait {2}

     # Set user password to maximum length 64 (include 0-9 & a-z)
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

     # Login GUI with user account
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
     ::WEB::WebDrv_Set_Value {id} {username} {user_test} {20}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     if { "$PROJECT$" == "WIND" } {
        ::CONSOLE::Wait {1}
     } else {
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {abc123} {20}
     ::WEB::WebDrv_Set_Value {id} {authPasswd} {abc123} {20}
     ::WEB::WebDrv_Click {id} {cgPwApply} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     }
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
   }
<TCL_Block_End>

# Back to default setting
# Set admin account password back to default
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::WEB::WebDrv_OpenWebSite {$CPEWEB$/AdvancedHiddenSetup} {A1000}
     ::WEB::WebDrv_Set_Value {id} {userpassword} {$CPEPASSWORD$} {20}
     ::WEB::WebDrv_Click {id} {loginBtn} {20}
   } else {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
   }
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {acc_editBtn0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {oldPasswd} {Aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaaa12345aaaa} {20}
::WEB::WebDrv_Set_Value {id} {newPasswd} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {$USER_LOGIN_PASSWORD$} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" || "$PROJECT$" == "US" || "$PROJECT$" == "WIND" } {
     # Delete new user account
     ::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
     ::CONSOLE::Wait {1}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
   }
<TCL_Block_End>

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-121 User account cannot login non-GUI remote management service : SSH/ telnet/ FTP/ console (Only supervisor and admin account can login) >

# For project
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" || "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {No user account} {1}
   }
<TCL_Block_End>

# Set SSH service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT SSH Service >" [list {$SSH_Mode=LAN_ONLY} {$SSH_Port=22}]

# Add a new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::WEB::WebDrv_Click {id} {adduser} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {Aabcd123} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {Aabcd123} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {abcd123} {20}
    ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {abcd123} {20}
}
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check user account can not login via console
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {user123} {Aabcd123}
} else {
    ::CONSOLE::Use_ZLD_WKS_Login {Local} {user123} {abcd123}
}
<TCL_Block_End>
::CONSOLE::Wait_String {5} {Please press Enter to activate this console.} {PASS}
::CONSOLE::Wait {2}

# Check user account can not login via SSH
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {user123} {Aabcd123} {FAIL} {Permission denied, please try again.}
} else {
    ::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {user123} {abcd123} {FAIL} {Permission denied, please try again.}
}
<TCL_Block_End>


# Check user account can not login via telnet
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT TELNET Service >" [list {$TELNET_Mode=LAN_ONLY} {$TELNET_Port=23}]
    ::CONSOLE::Check_WKS_Telnet_Exist {LAN1_WKS} {$LANIFDefaultAddress$} {user123} {Aabcd123} {FAIL} {Account: 'user123' TELNET permission denied}
} else {
    ::CONSOLE::Check_WKS_Telnet_Exist {LAN1_WKS} {$LANIFDefaultAddress$} {user123} {abcd123} {FAIL} {Account: 'user123' TELNET permission denied}
}
<TCL_Block_End>


# Check user account can not login via FTP
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::CONSOLE::Check_WKS_FTP_Connect {LAN1_WKS} {$LANIFDefaultAddress$} {user123} {Aabcd123} {FAIL}
} else {
    ::CONSOLE::Check_WKS_FTP_Connect {LAN1_WKS} {$LANIFDefaultAddress$} {user123} {abcd123} {FAIL}
}
<TCL_Block_End>
#::CONSOLE::Wait_String {5} {Operation timed out} {PASS}
#::CONSOLE::Wait_String {5} {timed out} {PASS}
::CONSOLE::Wait {2}

# Login with new user account
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::WEB::WebDrv_Set_Value {id} {username} {user123} {20}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {Aabcd123} {20}
} else {
    ::WEB::WebDrv_Set_Value {id} {userpassword} {abcd123} {20}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {loginBtn} {20}
::CONSOLE::Wait {2}

# Change user's password to "zyxel1234" (GUI show "Change Password" page)
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
        ::CONSOLE::Wait {1}
} else {
    ::WEB::WebDrv_Set_Value {id} {newPasswd} {zyxel1234} {20}
    ::WEB::WebDrv_Set_Value {id} {authPasswd} {zyxel1234} {20}                                                                                      
    ::WEB::WebDrv_Click {id} {cgPwApply} {20}
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
}
<TCL_Block_End>
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Delete new user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-122 Only root privilege can use below command : chmod/ chown/ wget >

# admin account login via console and check command "chmod/ chown/ wget"
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {sys atsh} {30} {Firmware Version} {}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_Scan {} {wget} {30} {^} {Invalid input}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_Scan {} {chown} {30} {^} {Invalid input}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_Scan {} {chmod} {30} {^} {Invalid input}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {1}

# root account login via console and check command "chmod/ chown/ wget"
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {sys atsh} {30} {Firmware Version} {}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_Scan {} {wget} {30} {Usage:} {wget [-c|--continue] [-s|--spider] [-q|--quiet] [-O|--output-document FILE]}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_Scan {} {chown} {30} {Usage:} {chown [-RhLHP]... OWNER[<.|:>[GROUP]] FILE...}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd_Scan {} {chmod} {30} {Usage:} {chmod [-R] MODE[,MODE]... FILE...}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {1}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-123 Check SSH support login protection >

# For TMNL 
<TCL_Block_Begin>
if { "$PROJECT$" == "TMNL" } {
     ::RUNNER::SkipCase {Not support to configure MGMT SSH service setting} {1}
   }
<TCL_Block_End>

# Set SSH service by TR-069
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< TR069 Set MGMT SSH Service >" [list {$SSH_Mode=LAN_ONLY} {$SSH_Port=22}]

<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     # Add a new user account first
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     ::WEB::WebDrv_Click {id} {adduser} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Set_Value {id} {accountName} {user123} {20}
     ::WEB::WebDrv_Set_Value {id} {newPasswd} {abcd123} {20}
     ::WEB::WebDrv_Set_Value {id} {verifyNewpassword} {abcd123} {20}
     ::WEB::WebDrv_List_Select {id} {accountGroupName} {text} {User} {20}
     ::WEB::WebDrv_Click {id} {button_Panel_iduserAccount_1_0} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
   }
<TCL_Block_End>

# Login SSH via supervisor account with wrong password for 3 times
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$CPE_ROOT_NAME$} {a123456} {FAIL} {Permission denied, please try again.}
::CONSOLE::Wait {2}
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$CPE_ROOT_NAME$} {a123456} {FAIL} {Permission denied, please try again.}
::CONSOLE::Wait {2}
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$CPE_ROOT_NAME$} {a123456} {Don't Care} {Connection to $LANIFDefaultAddress$ closed.}
::CONSOLE::Wait {2}

# Keyin correct password at the 4th time, and check that SSH kick out/disconnect. (#169111)
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$} {Don't Care} {Connection to $LANIFDefaultAddress$ closed.}
::CONSOLE::Wait {2}

# Login SSH via admin account with wrong password for 3 times
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$USER_LOGIN_NAME$} {a123456} {FAIL} {Permission denied, please try again.}
::CONSOLE::Wait {2}
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$USER_LOGIN_NAME$} {a123456} {FAIL} {Permission denied, please try again.}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" } {
	::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$USER_LOGIN_NAME$} {a123456} {Don't Care} {Permission denied, please try again.}
} else {
	::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$USER_LOGIN_NAME$} {a123456} {Don't Care} {Connection to $LANIFDefaultAddress$ closed.}
}
<TCL_Block_End>
::CONSOLE::Wait {2}

# Keyin correct password at the 4th time, and check that SSH kick out/disconnect. (#169111)
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$} {Don't Care} {Connection to $LANIFDefaultAddress$ closed.}
::CONSOLE::Wait {2}

# Login SSH via user account with wrong password (user account can't login SSH)
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {user123} {a123456} {FAIL} {Permission denied, please try again.}
     ::CONSOLE::Wait {2}
     ::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {user123} {a123456} {FAIL} {Permission denied, please try again.}
     ::CONSOLE::Wait {2}
     ::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {user123} {a123456} {Don't Care} {Permission denied, please try again.}
     ::CONSOLE::Wait {2}
	 	 
	 # Keyin correct password at the 4th time, and check that SSH kick out/disconnect. (#169111)
	 ::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {user123} {abcd123} {Don't Care} {Permission denied, please try again.} 
	 ::CONSOLE::Wait {2}
}
<TCL_Block_End>

# Wait lock period 5 minutes
::CONSOLE::Wait {300}

# Login SSH via supervisor/admin/user account (user account can't login SSH)
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$} {PASS}
::CONSOLE::Wait {2}
::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {$USER_LOGIN_NAME$} {$USER_LOGIN_PASSWORD$} {PASS}
::CONSOLE::Wait {2}
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     ::CONSOLE::Check_WKS_SSH_Exist {LAN1_WKS} {$LANIFDefaultAddress$ -p 22} {user123} {abcd123} {FAIL} {Permission denied, please try again.}
     ::CONSOLE::Wait {2}
   }
<TCL_Block_End>

# Back to default setting
<TCL_Block_Begin>
if { "$PROJECT$" == "Generic" } {
     # Delete new user account
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< User Account Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {acc_deleteBtn1} {20}
     ::CONSOLE::Wait {1}
     ::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
   }
<TCL_Block_End>

-CaseEnd-



%ENV-BAT%
+CaseStart+
< [Function-1] OPAL-124_1 Modify Time Server address and Time Zone are work correctly >

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
 
# Check device can display correct time
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {2}

# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
# Check time
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-BAT%
+CaseStart+
< [Function-1] OPAL-124_2 Modify Time Server address and Time Zone are work correctly (Error recovery - Power On/Off) >

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Power off and power on
<TCL_Block_Begin>
if { "$Power_Switch$" == "yes" } {
     ::MISC::Setup_Power_Switch {SW_1} {Off}
     ::CONSOLE::Wait {5}
     ::MISC::Setup_Power_Switch {SW_1} {On}
     ::CONSOLE::Wait {200}
   }
<TCL_Block_End>
 
# Check device can display correct time
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {2}

# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
# Check time
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-125 Re-plug WAN interface, check DUT will auto synchronize and get correct system time with specified SNTP Time server after got new WAN IP address >

# Check WAN interface 
<TCL_Block_Begin>
if { "$PON_Product$" != "no" } {
     ::RUNNER::SkipCase {ACTS can't disconnect PON WAN interface} {1}
   }
<TCL_Block_End>

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
  
# Unplug ETH WAN cable
::MISC::Enable_Network_Interface {WAN1} {Disable}
::MISC::Enable_xDSL_Line {1} {Disable}
::CONSOLE::Wait {40}

# Re-plug ETH WAN cable
::MISC::Enable_Network_Interface {WAN1} {Enable}
::CONSOLE::Wait {60}

# Check device can display correct time
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-126 Reboot DUT, check DUT will auto synchronize and get correct system time with specified SNTP Time server after got new WAN IP address >

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Reboot CPE
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd {} {\n}
::CONSOLE::CI_Cmd {} {reboot}
::CONSOLE::Wait {200}
<TCL_Block_Begin>
if { "$sysName$" == "PMG5617-T20C" } {
     ::CONSOLE::Wait {20}
   }
<TCL_Block_End>
 
# Check device can display correct time
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-127 Modify "Daylight Savings" settings by day, check DUT will synchronize and get correct system time >

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Enable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {sdayrule1} {20}
::WEB::WebDrv_List_Select {id} {startday} {option_value} {1} {20}
::WEB::WebDrv_List_Select {id} {startmonth} {text} {January} {20}
::WEB::WebDrv_List_Select {id} {starthour} {option_value} {0} {20}
::WEB::WebDrv_List_Select {id} {startMin} {option_value} {1} {20}
::WEB::WebDrv_Click {id} {edayrule1} {20}
::WEB::WebDrv_List_Select {id} {endday} {option_value} {31} {20}
::WEB::WebDrv_List_Select {id} {endmonth} {text} {December} {20}
::WEB::WebDrv_List_Select {id} {endhour} {option_value} {23} {20}
::WEB::WebDrv_List_Select {id} {endmin} {option_value} {59} {20}

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
 
# Check device can display correct time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {3660}
#::MISC::ACTS_Dummy_Response {PASS} "$::time_diff"
<TCL_Block_Begin>
if { ( $::time_diff >= 3540) && ( $::time_diff <= 3660) } {
	::MISC::ACTS_Dummy_Response {PASS} "Daylight Savings is work."
	::CONSOLE::Wait {1}
} else {
	::MISC::ACTS_Dummy_Response {FAIL} "Daylight Savings can not work. System Time is $::current_time and DUT time is $::dut_time"
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check device can display correct time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

# # Back to default setup 
# Enable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {sdayrule2} {20}
::WEB::WebDrv_List_Select {id} {startdayofweek} {text} {Last} {20}
::WEB::WebDrv_List_Select {id} {Maintenance_Time_orderWeekDay2} {text} {Sunday} {20}
::WEB::WebDrv_List_Select {id} {startmonth} {text} {March} {20}
::WEB::WebDrv_List_Select {id} {starthour} {option_value} {2} {20}
::WEB::WebDrv_List_Select {id} {startMin} {option_value} {0} {20}
::WEB::WebDrv_Click {id} {edayrule2} {20}
::WEB::WebDrv_List_Select {id} {endweek} {text} {Last} {20}
::WEB::WebDrv_List_Select {id} {endDayofWeek} {text} {Sunday} {20}
::WEB::WebDrv_List_Select {id} {endmonth} {text} {October} {20}
::WEB::WebDrv_List_Select {id} {endhour} {option_value} {3} {20}
::WEB::WebDrv_List_Select {id} {endmin} {option_value} {0} {20}

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-128 Modify Time Server address with manual mode >

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.stdtime.gov.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check device can display correct time
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-129 Check Time Server list >

# Set NTP server-1
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {clock.fmt.he.net} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# # Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set NTP server-2
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {clock.nyc.he.net} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

## Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set NTP server-3
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {clock.sjc.he.net} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
 
# # Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set NTP server-4
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {clock.via.net} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# # Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set NTP server-5
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {ntp1.tummy.com} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# # Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Set NTP server-6
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {time.cachenetworks.com} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
 
## Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-130 Check GUI pop up warning message when Time Server is error >

# Set invalid time server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {abc} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {applyBtn} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-132 Check Time Server can fall back to second Time Server when first Time Server is down >

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {6.6.6.6} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {clock.fmt.he.net} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Check device can display correct time
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-





%ENV-L3%
+CaseStart+
< [Function-1] OPAL-134 (VDSL PPPoE) Check NTP function can work well >

# Check WAN interface 
<TCL_Block_Begin>
if { "$PON_Product$" != "no" || "$Only_ETHWAN$" == "yes" } {
     ::RUNNER::SkipCase {For xDSL WAN} {1}
   }
<TCL_Block_End>

# For WIND, set Classification Setup edit VLAN ID Tag to unchange 
<TCL_Block_Begin>
if { "$PROJECT$" == "WIND" && "$Only_ETHWAN$" == "no" } {
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< QoS Webpage >"
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     ::WEB::WebDrv_Click {id} {tab_Network_QoS_ClassificationSetup_Tab} {20}
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     
     for { set i 0 } {$i <= 5} { incr i 1 } {
        ::WEB::WebDrv_Click {id} "Network_QoS_ClassificationSetup_Edit$i" {20}
        ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
        ::WEB::WebDrv_List_Select {id} {q_class_vlanActionSelect} {text} {Unchange} {20}
        ::CONSOLE::Wait {1}
        ::WEB::WebDrv_Click {id} {q_class_applyBtn}
        ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
     }
     ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
     ::CONSOLE::Wait {15}             
   }
<TCL_Block_End>

# Change WAN type to VDSL
::MISC::Enable_Network_Interface {WAN1} {Disable}
::MISC::Enable_xDSL_Line {1} {Enable}
::MISC::Setup_xDSL_Line {1} {VDSL}
::CONSOLE::Wait {40}
<TCL_Block_Begin>
if { "$Econet_Platform$" == "yes" } {
     ::CONSOLE::Wait {20}
   }
<TCL_Block_End>

# Modify default VDSL WAN to PPPoE
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_VDSL_BTN$} {$Encapsulation=PPPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
::CONSOLE::Wait {15}

# Check default route interface is PPPoE
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
<TCL_Block_Begin>
set result [::CONSOLE::CI_Cmd_Scan {} {ip route} {30} {default via 172.205.77.254 dev} {ppp}]
	if { ($result != 0) && ($result != "PASS") } {
    ::MISC::ACTS_Dummy_Response {PASS} "Retry : Check default route "
    ::CONSOLE::Wait {30}
    ::CONSOLE::CI_Cmd_Scan {} {ip route} {30} {default via 172.205.77.254 dev} {ppp}
    }
<TCL_Block_End>
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Back to default setting
# Change back WAN type to ETH WAN
::MISC::Enable_Network_Interface {WAN1} {Enable}
::CONSOLE::Wait {40}
<TCL_Block_Begin>
if { "$Econet_Platform$" == "yes" } {
     ::CONSOLE::Wait {20}
   }
<TCL_Block_End>

-CaseEnd-




%ENV-L3%
+CaseStart+
< [Function-1] OPAL-137_1 (ETH IPoE) Check NTP function can work well >

# Check WAN interface
<TCL_Block_Begin>
if { "$PON_Product$" != "no" } {
     ::RUNNER::SkipCase {For ETH WAN} {1}
   }
<TCL_Block_End>

# Modify default ETH WAN to IPoE
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_ETH_BTN$} {$Encapsulation=IPoE} {$IP_Mode=DualStack} {$VLAN=0} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
::CONSOLE::Wait {15}

# Check default route interface is IPoE
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {ip route} {30} {default via 172.202.77.1 dev} {$DEFAULT_ETH_WAN_Interface$}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"
    
-CaseEnd-





%ENV-L3%
+CaseStart+
< [Function-1] OPAL-137_2 (PON IPoE) Check NTP function can work well >

# Check WAN interface 
<TCL_Block_Begin>
if { "$PON_Product$" == "no" } {
     ::RUNNER::SkipCase {For PON WAN} {1}
   }
<TCL_Block_End>

# Modify default PON WAN to IPoE
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_PON_BTN$} {$Encapsulation=IPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
::CONSOLE::Wait {15}

# Check default route interface is IPoE
::CONSOLE::Local
::CONSOLE::Wait {3}
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::CI_Cmd_Scan {} {ip route} {30} {default via 172.202.77.1 dev} {$DEFAULT_PON_WAN_Interface$}
::CONSOLE::Wait {1}
::CONSOLE::CI_Cmd {} {exit}
::CONSOLE::Wait {3}

# Set NTP server
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Time Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {ntpServerSel1} {text} {Other} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {serveraddr1} {time.windows.com} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel2} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel3} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel4} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {ntpServerSel5} {text} {None} {20}
::WEB::WebDrv_List_Select {id} {mtenTimeZone} {option_value} {CST-8-2} {20}

# Disable Daylight Savings
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"daylightsave\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {daylightsave} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# # Check device can display correct time
# Check date
set ::date ""
::MISC::Get_System_Date {::date}
::WEB::WebDrv_Check_Text {id} {showDate} "$::date" {20} {PASS} {full} 
# Check time
::WEB::WebDrv_Get_Text {id} {showTime} {::dut_time} {20}
::MISC::Get_System_Time {::current_time}
::MISC::Time_Diff "$::current_time" "$::dut_time" {::time_diff} {60}

::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-





%ENV-L3%
+CaseStart+
< [Function-1] OPAL-139 Check Syslog Logging on Local File mode >
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - Firewall log.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Clear Log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End> 

# Change firewall to High 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"          
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[3]} {20}
::CONSOLE::Wait {1}          
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"      

# Check firewall log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}      
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {20} {PASS} {full}
::CONSOLE::Wait {2}                                                                                                                              

# # Back to default setup 
# Disable log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      ::WEB::WebDrv_Click {id} {syslog} {20}
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change firewall to Medium
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[2]} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Check no firewall log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}      
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {zcmdModuleCfg: Firewall: Change firewall level from 'High' to 'Medium'} {20} {FAIL} {full}
::CONSOLE::Wait {2} 
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End>

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-140 Remote Syslog Logging with "IPv4 Address" and UDP Port "514", check DUT will send out all system logs with correct format and content >

# Capture LAN_PC IP
::CONSOLE::Local
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
set ::cmd_response ""
set ::temp1 ""                                                                   
#set ::LAN_ip "0.0.0.0"
::CONSOLE::CI_Cmd_More {} {ipconfig > C:/Users/acts/Downloads/a.txt} {15}
::CONSOLE::Wait {15}
set ::fd [open C:/Users/acts/Downloads/a.txt r]
set ::content [read $::fd]
close $::fd
regexp {IPv4 Address. . . . . . . . . . . : $LAN_IP_Prefix$(.*?) } $::content -> ::temp1
set ::LAN_ip_last [string trim $::temp1]
set ::LAN_ip "$LAN_IP_Prefix$$::LAN_ip_last"
::CONSOLE::Close_Shell {DOS_Shell}
::MISC::ACTS_Dummy_Response {PASS} "LAN_PC ip=$::LAN_ip"
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - Firewall log.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>
                            
::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {Remote} {20}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::WEB::WebDrv_Set_Value {id} {syslog_server_addr} "$::LAN_ip" {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Start Syslog
::GUIAPP::Syslog_Start
::CONSOLE::Wait {10}

# Change firewall to High 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"          
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[3]} {20}
::CONSOLE::Wait {1}          
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {40}      

# Check firewall log
::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {PASS}      
::CONSOLE::Wait {1} 

#<TCL_Block_Begin>
#set result [::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {PASS} ]
#	if { ($result != 0) && ($result != "PASS") } {
#    ::MISC::ACTS_Dummy_Response {PASS} "Retry : Check firewall log "
#    ::CONSOLE::Wait {30}
#    ::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {PASS} 
#    }
#<TCL_Block_End>
                                                                                                                             
# Back to default setup 
# Disable log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change firewall to Medium
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[2]} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {20}

# Check no firewall log
::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'High' to 'Medium'} {FAIL}       
::CONSOLE::Wait {1}

# Set syslog mode to Local
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {Local} {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Close Syslog
::GUIAPP::Syslog_Close
::CONSOLE::Wait {3}

# Delete a.txt
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del a.txt} {30}
::CONSOLE::Wait {2}

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-142 Check Syslog Logging Remote on Local file and Remote mode >

# Capture LAN_PC IP
::CONSOLE::Local
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
set ::cmd_response ""
set ::temp1 ""                                                                   
#set ::LAN_ip "0.0.0.0"
::CONSOLE::CI_Cmd_More {} {ipconfig > C:/Users/acts/Downloads/a.txt} {15}
::CONSOLE::Wait {15}
set ::fd [open C:/Users/acts/Downloads/a.txt r]
set ::content [read $::fd]
close $::fd
regexp {IPv4 Address. . . . . . . . . . . : $LAN_IP_Prefix$(.*?) } $::content -> ::temp1
set ::LAN_ip_last [string trim $::temp1]
set ::LAN_ip "$LAN_IP_Prefix$$::LAN_ip_last"
::CONSOLE::Close_Shell {DOS_Shell}
::MISC::ACTS_Dummy_Response {PASS} "LAN_PC ip=$::LAN_ip"
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - Firewall log.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>

::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {LocalRemote} {20}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::WEB::WebDrv_Set_Value {id} {syslog_server_addr} "$::LAN_ip" {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Start Syslog
::GUIAPP::Syslog_Start
::CONSOLE::Wait {10}

# Clear Log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End> 

# Change firewall to High 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"          
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[3]} {20}
::CONSOLE::Wait {1}          
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {15}      

# Check firewall log on Syslog server
::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {PASS}      
::CONSOLE::Wait {1} 

# Check firewall log on GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}      
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {20} {PASS} {full}
::CONSOLE::Wait {2}
                                                                                                                             
# # Back to default setup 
# Disable log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change firewall to Medium
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[2]} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {5}

# Check no firewall log on Syslog
::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'High' to 'Medium'} {FAIL}       
::CONSOLE::Wait {1}

# Check no firewall log on GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}      
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {zcmdModuleCfg: Firewall: Change firewall level from 'High' to 'Medium'} {20} {FAIL} {full}
::CONSOLE::Wait {2} 
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End>

# Set syslog mode to Local
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {Local} {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Close Syslog
::GUIAPP::Syslog_Close
::CONSOLE::Wait {3}

# Delete a.txt
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del a.txt} {30}
::CONSOLE::Wait {2}

-CaseEnd- 



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-143 Verify Syslog Server support "Server NAME" on LAN >

# Capture LAN_PC IP
::CONSOLE::Local
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
set ::cmd_response ""
set ::temp1 ""                                                                   
#set ::LAN_ip "0.0.0.0"
::CONSOLE::CI_Cmd_More {} {ipconfig > C:/Users/acts/Downloads/a.txt} {15}
::CONSOLE::Wait {15}
set ::fd [open C:/Users/acts/Downloads/a.txt r]
set ::content [read $::fd]
close $::fd
regexp {IPv4 Address. . . . . . . . . . . : $LAN_IP_Prefix$(.*?) } $::content -> ::temp1
set ::LAN_ip_last [string trim $::temp1]
set ::LAN_ip "$LAN_IP_Prefix$$::LAN_ip_last"
::CONSOLE::Close_Shell {DOS_Shell}
::MISC::ACTS_Dummy_Response {PASS} "LAN_PC ip=$::LAN_ip"
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# From DNS page add a host name first
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< DNS Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {dnsentry_add_btn} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {host_name_dnsentry_input} {syslog.syslog} {20}
::WEB::WebDrv_Set_Value {id} {dnsentry_ipaddr_for_input_1} "$::LAN_IP_1" {20}
::WEB::WebDrv_Set_Value {id} {dnsentry_ipaddr_for_input_2} "$::LAN_IP_2" {20}
::WEB::WebDrv_Set_Value {id} {dnsentry_ipaddr_for_input_3} "$::LAN_IP_3" {20}
::WEB::WebDrv_Set_Value {id} {dnsentry_ipaddr_for_input_4} "$::LAN_ip_last" {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {button_Panel_iddnsentry_1_0} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - Firewall log.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>

::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {Remote} {20}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::WEB::WebDrv_Set_Value {id} {syslog_server_addr} {syslog.syslog} {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Start Syslog
::GUIAPP::Syslog_Start
::CONSOLE::Wait {10}

# Change firewall to High 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"          
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[3]} {20}
::CONSOLE::Wait {1}          
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {30}      

# Check firewall log
::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {PASS}      
::CONSOLE::Wait {1} 
                                                                                                                             
# # Back to default setup 
# Disable log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      ::WEB::WebDrv_Click {id} {syslog} {20}
      }
<TCL_Block_End>
::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {Local} {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change firewall to Medium
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[2]} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {5}

# From DNS page delete host name
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< DNS Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {dnsentry_Fordelete_0_000_delete} {20}
::CONSOLE::Wait {1}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20} 
::CONSOLE::Wait {1}                      

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Close Syslog
::GUIAPP::Syslog_Close
::CONSOLE::Wait {3}

# Delete a.txt
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del a.txt} {30}
::CONSOLE::Wait {2}

-CaseEnd-



%ENV-L1%
+CaseStart+
< [Function-1] OPAL-148 Check Enable/Disable Syslog function >

# Capture LAN_PC IP
::CONSOLE::Local
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
set ::cmd_response ""
set ::temp1 ""                                                                   
#set ::LAN_ip "0.0.0.0"
::CONSOLE::CI_Cmd_More {} {ipconfig > C:/Users/acts/Downloads/a.txt} {15}
::CONSOLE::Wait {15}
set ::fd [open C:/Users/acts/Downloads/a.txt r]
set ::content [read $::fd]
close $::fd
regexp {IPv4 Address. . . . . . . . . . . : $LAN_IP_Prefix$(.*?) } $::content -> ::temp1
set ::LAN_ip_last [string trim $::temp1]
set ::LAN_ip "$LAN_IP_Prefix$$::LAN_ip_last"
::CONSOLE::Close_Shell {DOS_Shell}
::MISC::ACTS_Dummy_Response {PASS} "LAN_PC ip=$::LAN_ip"
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - Firewall log.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>

::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {LocalRemote} {20}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::WEB::WebDrv_Set_Value {id} {syslog_server_addr} "$::LAN_ip" {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Clear Log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End> 

# Start Syslog
::GUIAPP::Syslog_Start
::CONSOLE::Wait {10}

# Change firewall to High 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"          
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[3]} {20}
::CONSOLE::Wait {1}          
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {15}      

# Check firewall log on Syslog server
<TCL_Block_Begin>
set result [::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {PASS}]
    if { ($result != 0) && ($result != "PASS") } {
		::MISC::ACTS_Dummy_Response {WARNING} "Scan firewall log FAIL at the 1st time. Retry 2nd time."
		::CONSOLE::Wait {30}
		::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {PASS}
    }
<TCL_Block_End> 

# Check firewall log on GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}      
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'} {20} {PASS} {full}
::CONSOLE::Wait {2}
                                                                                                                             
# Back to default setup 
# Disable log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Change firewall to Medium
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[2]} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {10}

# Check no firewall log on Syslog
::GUIAPP::Syslog_Scan {zcmdModuleCfg: Firewall: Change firewall level from 'High' to 'Medium'} {FAIL}       
::CONSOLE::Wait {1}

# Check no firewall log on GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}      
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {zcmdModuleCfg: Firewall: Change firewall level from 'High' to 'Medium'} {20} {FAIL} {full}
::CONSOLE::Wait {2} 
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End>

# Set syslog mode to Local
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_List_Select {id} {syslog_modeSelect} {option_value} {Local} {20}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Close Syslog
::GUIAPP::Syslog_Close
::CONSOLE::Wait {3}

# Delete a.txt
::CONSOLE::Open_Shell {DOS_Shell} {CMD} {}
::CONSOLE::CI_Cmd_More {} {c:} {10} {cd "C:\Users\acts\Downloads"} {10} {del a.txt} {30}
::CONSOLE::Wait {2}

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-22621 Check DUT support ZlogSetting page >

# Login GUI with admin/user account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, disable log setting.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
        set ::target_value ""
        set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
        if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
        }
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# open http://192.168.1.1/ZlogSetting
::WEB::WebDrv_OpenWebSite {$CPEWEB$/ZlogSetting} {A1000}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# should redirect to http://192.168.1.1
::WEB::WebDrv_Check_Text {id} {card_sysinfo_fwversion} {$FIRMWARE_VERSION$} {20} {PASS}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Login GUI with supervisor account, open http://192.168.1.1/ZlogSetting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_OpenWebSite {$CPEWEB$/ZlogSetting} {A1000}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# should be able to open Zlog setting page, status would be "Disable"
::WEB::WebDrv_Check_Text {xpath} {//*[@id="tab_Maintenance_ZlogSetting"]/h5[1]/div[1]/div/div/span} {Disabled} {20} {PASS}
::CONSOLE::Wait {1}

# Enable Zlog
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"zlog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {zlog} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {zlog_All} {20}
::WEB::WebDrv_List_Select {id} {zlog_severity} {option_value} {DEBUG} {20}
::WEB::WebDrv_Click {id} {zlog_console_label} {20}
::WEB::WebDrv_Click {id} {apply_zlog_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Text {xpath} {//*[@id="tab_Maintenance_ZlogSetting"]/h5[1]/div[1]/div/div/span} {Enabled} {20} {PASS}                                             
::CONSOLE::Wait {1} 

# Change firewall to High and check log in console
::CONSOLE::Local
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$}
::CONSOLE::Wait {1} 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"          
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[3]} {20}
::CONSOLE::Wait {1}          
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::CONSOLE::Wait_String {60} {zcmdModuleCfg: Firewall: Change firewall level from 'Medium' to 'High'}
::CONSOLE::Wait {5}

# # Back to default setup 
# Change firewall to Medium
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[2]} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {5}

# Disable Zlog
::WEB::WebDrv_OpenWebSite {$CPEWEB$/ZlogSetting} {A1000}
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"zlog\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {zlog} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>
::WEB::WebDrv_Click {id} {zlog_console_label} {20}
::WEB::WebDrv_Click {id} {apply_zlog_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Logout GUI
::WEB::WebDrv_OpenWebSite {$CPEWEB$} {A1000}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >" 

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-149 Check Enable/Disable E-mail Log function >
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Add new E-mail account on E-mail Notification page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< E-mail Notification Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="tab_Maintenance_EmailNotification"]/div[2]/div} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Set_Value {id} {mailserveraddress} {172.202.77.10} {20}
::WEB::WebDrv_Set_Value {id} {Smtp_AuthUser} {auto100@automail.com} {20}
::WEB::WebDrv_Set_Value {id} {Smtp_AuthPass} {1234} {20}
::WEB::WebDrv_Set_Value {id} {mailaddress} {auto100@automail.com} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {Maintenance_EmailNotify_AddMail_ApplyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - Firewall log.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>

# Enable E-mail Log setting
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"logMail\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {logMail} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_List_Select {id} {log_MailServer} {text} {auto100@automail.com} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {logMailSubject} {[ACTS] System Log Mail} {20}
::WEB::WebDrv_Set_Value {id} {securityLogMailSubject} {[ACTS] Security Log Mail} {20}
::WEB::WebDrv_Set_Value {id} {logMailAddress} {auto100@automail.com} {20}
::WEB::WebDrv_Set_Value {id} {alertMailAddress} {auto100@automail.com} {20}

::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Clear Log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End> 

# Capture CPE WAN IP
::CONSOLE::Use_ZLD_WKS_Login {Local} {$CPE_ROOT_NAME$} {$CPE_ROOT_PASSWORD$} 
<TCL_Block_Begin>
set ::cmd_response ""                                                                   
set ::WAN_ip "0.0.0.0"
if { "$PON_Product$" != "no" } {
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_PON_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_PON_WAN_Interface$} {30} {inet addr} "$::WAN_ip"

} else {     
    ::CONSOLE::CI_Capture_Response {} "ifconfig $DEFAULT_ETH_WAN_Interface$" 5 ::cmd_response
    regexp {inet addr:(.*?) } $::cmd_response -> ::WAN_ip
    ::CONSOLE::CI_Cmd_Scan {} {ifconfig $DEFAULT_ETH_WAN_Interface$} {30} {inet addr} "$::WAN_ip"
      
}   
<TCL_Block_End>

# From Hping3 server to attack DUT, the command is "hping3 -S DUT_WAN_IP -p 80 -i u1"
::CONSOLE::Use_ZLD_WKS_Login {Shell_WAN_WKS} {SSH} {WAN_WKS} {root} {1234} 
::CONSOLE::CI_Cmd {} "hping3 -S $::WAN_ip -p 80 -i u1"
::CONSOLE::Wait {15}
#::CONSOLE::CI_Cmd {} {^C}
#::CONSOLE::Wait {3}     

# Check firewall log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}
::WEB::WebDrv_List_Select {id} {SystemMonitor_Log_SystemLog_Cate} {option_value} {attack} {20}
::CONSOLE::Wait {5}
<TCL_Block_Begin>
set result [::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr[1]/td[6]} {SYN_FLOODING ATTACK} {20} {PASS} {partial}]
    if { ($result != 0) && ($result != "PASS") } {
		::MISC::ACTS_Dummy_Response {WARNING} "Check ICMP_FLOODING ATTACK log failed at the 1st time. Retry 2nd time to check if get PING OF DEATH ATTACK log"
		::CONSOLE::Wait {30}
		::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button2} {20}
		::CONSOLE::Wait {5}
		::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr[1]/td[6]} {SYN_FLOODING ATTACK} {20} {PASS} {partial}    
	} else {
		::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr[1]/td[6]} {SYN_FLOODING ATTACK} {20} {PASS} {partial}		
	}
<TCL_Block_End>

# Clear Log 
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End> 

# Check E-mail log
::TESTLINK::Zymail {Receive}
::TESTLINK::File_Modify {$Tool File Path$/MailContent.txt} {[ACTS] Security Log Mail} {} {PASS}
::GUIAPP::Kill_Program_By_Name "Zymail.exe"
::TESTLINK::Zymail {Delete}
::GUIAPP::Kill_Program_By_Name "Zymail.exe"
                                                                                                 
# # Back to default setup 
# Disable log setting & E-mail Log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      ::WEB::WebDrv_Click {id} {syslog} {20}
      }
<TCL_Block_End>

<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"logMail\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {logMail} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Delete E-mail account on E-mail Notification page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< E-mail Notification Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {Maintenance_EmailNotification_Edit1} {20}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {2}                      

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L2%
+CaseStart+
< [Function-1] OPAL-150 Check Email log now button >
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Add new E-mail account on E-mail Notification page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< E-mail Notification Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="tab_Maintenance_EmailNotification"]/div[2]/div} {20}
::CONSOLE::Wait {2}
::WEB::WebDrv_Set_Value {id} {mailserveraddress} {172.202.77.10} {20}
::WEB::WebDrv_Set_Value {id} {Smtp_AuthUser} {auto100@automail.com} {20}
::WEB::WebDrv_Set_Value {id} {Smtp_AuthPass} {1234} {20}
::WEB::WebDrv_Set_Value {id} {mailaddress} {auto100@automail.com} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {Maintenance_EmailNotify_AddMail_ApplyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - Firewall log.
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      set ::target_value ""
      set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"syslog\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
      if { ($::temp != 0) && ( $::temp != "PASS") } {
        	::WEB::WebDrv_Click {id} {syslog} {20}
        	::CONSOLE::Wait {1}
         }
      }
<TCL_Block_End>

# Enable E-mail Log setting
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"logMail\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {logMail} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_List_Select {id} {log_MailServer} {text} {auto100@automail.com} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Set_Value {id} {logMailSubject} {[ACTS] System Log Mail} {20}
::WEB::WebDrv_Set_Value {id} {securityLogMailSubject} {[ACTS] Security Log Mail} {20}
::WEB::WebDrv_Set_Value {id} {logMailAddress} {auto100@automail.com} {20}
::WEB::WebDrv_Set_Value {id} {alertMailAddress} {auto100@automail.com} {20}

::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Clear Log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End> 

# Change firewall to High 
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"          
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[3]} {20}
::CONSOLE::Wait {1}          
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
      
# Modify default WAN to PPPoE
<TCL_Block_Begin>
if { "$PON_Product$" == "10GPON" || "$PON_Product$" == "GPON" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_PON_BTN$} {$Encapsulation=PPPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
} else {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_ETH_BTN$} {$Encapsulation=PPPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
}
<TCL_Block_End> 

# Modify default WAN to IPoE
<TCL_Block_Begin>
if { "$PON_Product$" == "10GPON" || "$PON_Product$" == "GPON" } {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_PON_BTN$} {$Encapsulation=IPoE} {$IP_Mode=DualStack} {$VLAN=1} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
} else {
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Broadband Webpage >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
    ::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Set WAN >" [list {$WAN_Type=$BB_ETH_BTN$} {$Encapsulation=IPoE} {$IP_Mode=DualStack} {$VLAN=0} {$NAT=1} {$Default_Gateway=1} {$IP_Address=Auto} {$DNS_Server=Auto} {$IPv6_Default_Gateway=1} {$IPv6_Address=Auto} {$DNSv6_Server=Auto}] 
    ::CONSOLE::Wait {15}
}
<TCL_Block_End>     

# Check log on System Log page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SecurityLog_Table"]/tbody/tr[1]/td[5]} {dhcp} {20} {PASS} {partial}
::CONSOLE::Wait {2}

# Press Email log now button to send email
::WEB::WebDrv_Click {id} {SystemMonitor_Log_SecurityLog_Button4} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} 
::CONSOLE::Wait {2}

# Clear Log 
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SecurityLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End>

# Check log on Security Log page
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}
::WEB::WebDrv_List_Select {id} {SystemMonitor_Log_SystemLog_Cate} {option_value} {firewall} {20}
::CONSOLE::Wait {5}
<TCL_Block_Begin>
set result [::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {Firewall: Change firewall level from 'Medium' to 'High'} {20} {PASS} {partial}]
    if { ($result != 0) && ($result != "PASS") } {
		::MISC::ACTS_Dummy_Response {WARNING} "Check SYN_FLOODING ATTACK log failed at the 1st time. Retry 2nd time to check log"
		::CONSOLE::Wait {15}
		::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button2} {20}
		::CONSOLE::Wait {5}
		::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {Firewall: Change firewall level from 'Medium' to 'High'} {20} {PASS} {partial}
    } else {
		::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {Firewall: Change firewall level from 'Medium' to 'High'} {20} {PASS} {partial}		
	}
<TCL_Block_End>      
::CONSOLE::Wait {2} 

# Press Email log now button to send email
::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button4} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >" 
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20} 
::CONSOLE::Wait {2} 

# Clear Log 
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End>

# Check E-mail log
::TESTLINK::Zymail {Receive}
::TESTLINK::File_Modify {$Tool File Path$/MailContent.txt} {[ACTS] System Log Mail} {} {PASS}
::TESTLINK::File_Modify {$Tool File Path$/MailContent.txt} {[ACTS] Security Log Mail} {} {PASS}
::GUIAPP::Kill_Program_By_Name "Zymail.exe"
::TESTLINK::Zymail {Delete}
::GUIAPP::Kill_Program_By_Name "Zymail.exe"
                                                                                                 
# # Back to default setup 
# Disable log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      ::WEB::WebDrv_Click {id} {syslog} {20}
      }
<TCL_Block_End>

<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"logMail\"\]\[@class=\"switch  \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {logMail} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Delete E-mail account on E-mail Notification page
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< E-mail Notification Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {Maintenance_EmailNotification_Edit1} {20}
::TESTLINK::WebDrv_Click_Option {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div[2]/button/span} {id} {alertOKBtn} {20}
::CONSOLE::Wait {2}

# Change firewall to Medium
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Firewall Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {xpath} {//*[@id="l_g_firewallrange"]/div[1]/div[2]} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {l_g_applyBtn} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::CONSOLE::Wait {5}

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-151 View logs by Category: "Account" with Level: Informational >
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Go to Log setting page, enable log setting - account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      ::WEB::WebDrv_Click {id} {syslog} {20}
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {logCat_1_0_label} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Clear Log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {3}
<TCL_Block_Begin>
if { "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
     ::CONSOLE::Wait {1}
   } else {
     ::WEB::WebDrv_Click {id} {SystemMonitor_Log_SystemLog_Button1} {20}
     ::CONSOLE::Wait {2}
     ::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
     ::CONSOLE::Wait {1}
   }
<TCL_Block_End> 

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

# Login GUI with admin account
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Admin >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"    

# Check account log
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
::WEB::WebDrv_Click {id} {tab_SystemMonitor_Log_SecurityLog_Tab} {20}
::CONSOLE::Wait {5}
::WEB::WebDrv_List_Select {id} {SystemMonitor_Log_SystemLog_Cate} {option_value} {account} {20}
::CONSOLE::Wait {3}      
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr/td[6]} {zHttpd: Account: User 'admin' login from the host} {20} {PASS} {partial}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr[2]/td[6]} {zHttpd: Account: User 'supervisor' Session ID} {20} {PASS} {partial}
::CONSOLE::Wait {1}
::WEB::WebDrv_Check_Text {xpath} {//*[@id="SystemMonitor_Log_SystemLog_Table"]/tbody/tr[2]/td[6]} {logout from the host} {20} {PASS} {partial}
::CONSOLE::Wait {1}                                                                                                                               

# # Back to default setup 
# Disable log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
   if { "$sysName$" == "EX5510-B0" || "$PROJECT$" == "MD" || "$PROJECT$" == "MO" } {
      ::CONSOLE::Wait {2}
      } else {
      ::WEB::WebDrv_Click {id} {syslog} {20}
      }
<TCL_Block_End>
::WEB::WebDrv_Click {id} {logCat_1_0_label} {20}
::CONSOLE::Wait {1}
::WEB::WebDrv_Click {id} {apply_log_set} {20}
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-



%ENV-L3%
+CaseStart+
< [Function-1] OPAL-152 Check mail subject option with special characters >
    
# Login GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Login Supervisor >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"

# Enable E-mail Log setting
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Log Setting Webpage >"
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< GUI Response Time >"
<TCL_Block_Begin>
set ::target_value ""
set ::temp [::WEBAPP::WebDrv_Get_Text "xpath" "//label\[@id=\"logMail\"\]\[@class=\"switch active \"\]/span" ::target_value "1"]
if { ($::temp != 0) && ( $::temp != "PASS") } {
	::WEB::WebDrv_Click {id} {logMail} {20}
	::CONSOLE::Wait {1}
}
<TCL_Block_End>

::WEB::WebDrv_Set_Value {id} {logMailSubject} {@#%^&*()} {20}
::WEB::WebDrv_Click {id} {logMailAddress} {20}
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]} {It is impossible to enter special characters.} {20} {PASS} {full}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::WEB::WebDrv_Set_Value {id} {logMailSubject} {[ACTS] System Log Mail} {20}

::WEB::WebDrv_Set_Value {id} {securityLogMailSubject} {@#%^&*()} {20}
::WEB::WebDrv_Click {id} {logMailAddress} {20}
::WEB::WebDrv_Check_Text {xpath} {//*[@id="AlertBox"]/div[2]/div[2]} {It is impossible to enter special characters.} {20} {PASS} {full}
::WEB::WebDrv_Click {xpath} {//*[@id="AlertBox"]/div[2]/div[3]/div/button/span} {20}
::WEB::WebDrv_Set_Value {id} {securityLogMailSubject} {[ACTS] Security Log Mail} {20}

::WEB::WebDrv_Click {id} {cancel_log_set} {20}
::CONSOLE::Wait {2}

# Logout GUI
::TESTLINK::Run_Module "$MOD_PATH$$PROJECT$.mod" "< Web Logout >"

-CaseEnd-